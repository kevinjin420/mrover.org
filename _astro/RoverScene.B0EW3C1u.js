import{L as tt,F as Ht,B as it,C as qe,S as ye,a as Xe,V as pe,b as ke,D as Qi,c as Zi,d as Gt,M as we,e as Rt,f as qt,T as zt,g as Re,A as $t,h as en,i as $e,j as Ie,k as tn,l as nn,m as sn,P as nt,O as rn,n as Bt,o as on,p as an,q as Ge,G as st,Q as ot,r as Mt,s as ln,t as cn,u as St,v as dn,w as Fe,x as un,y as hn,z as pn,R as Oe,E as Vt,H as Jt,I as fn,J as mn,K as gn,N as bn,U as wn,W as yn,X as _n,Y as xn}from"./three.module.BeR4zCCC.js";import{r as Ke}from"./index.JXKNaeUN.js";import{g as kn}from"./index.CB87Sc6I.js";class vn extends tt{constructor(n){super(n)}load(n,a,o,w){const _=this,I=new Ht(this.manager);I.setPath(this.path),I.setResponseType("arraybuffer"),I.setRequestHeader(this.requestHeader),I.setWithCredentials(this.withCredentials),I.load(n,function(N){try{a(_.parse(N))}catch(z){w?w(z):console.error(z),_.manager.itemError(n)}},o,w)}parse(n){function a(G){const V=new DataView(G),J=32/8*3+32/8*3*3+16/8,ee=V.getUint32(80,!0);if(80+32/8+ee*J===V.byteLength)return!0;const K=[115,111,108,105,100];for(let M=0;M<5;M++)if(o(K,V,M))return!1;return!0}function o(G,V,J){for(let ee=0,X=G.length;ee<X;ee++)if(G[ee]!==V.getUint8(J+ee))return!1;return!0}function w(G){const V=new DataView(G),J=V.getUint32(80,!0);let ee,X,K,M=!1,se,P,u,R,q;for(let T=0;T<70;T++)V.getUint32(T,!1)==1129270351&&V.getUint8(T+4)==82&&V.getUint8(T+5)==61&&(M=!0,se=new Float32Array(J*3*3),P=V.getUint8(T+6)/255,u=V.getUint8(T+7)/255,R=V.getUint8(T+8)/255,q=V.getUint8(T+9)/255);const v=84,E=50,y=new it,m=new Float32Array(J*3*3),f=new Float32Array(J*3*3),O=new qe;for(let T=0;T<J;T++){const A=v+T*E,Y=V.getFloat32(A,!0),he=V.getFloat32(A+4,!0),ce=V.getFloat32(A+8,!0);if(M){const p=V.getUint16(A+48,!0);(p&32768)===0?(ee=(p&31)/31,X=(p>>5&31)/31,K=(p>>10&31)/31):(ee=P,X=u,K=R)}for(let p=1;p<=3;p++){const oe=A+p*12,W=T*3*3+(p-1)*3;m[W]=V.getFloat32(oe,!0),m[W+1]=V.getFloat32(oe+4,!0),m[W+2]=V.getFloat32(oe+8,!0),f[W]=Y,f[W+1]=he,f[W+2]=ce,M&&(O.setRGB(ee,X,K,ye),se[W]=O.r,se[W+1]=O.g,se[W+2]=O.b)}}return y.setAttribute("position",new Xe(m,3)),y.setAttribute("normal",new Xe(f,3)),M&&(y.setAttribute("color",new Xe(se,3)),y.hasColors=!0,y.alpha=q),y}function _(G){const V=new it,J=/solid([\s\S]*?)endsolid/g,ee=/facet([\s\S]*?)endfacet/g,X=/solid\s(.+)/;let K=0;const M=/[\s]+([+-]?(?:\d*)(?:\.\d*)?(?:[eE][+-]?\d+)?)/.source,se=new RegExp("vertex"+M+M+M,"g"),P=new RegExp("normal"+M+M+M,"g"),u=[],R=[],q=[],v=new pe;let E,y=0,m=0,f=0;for(;(E=J.exec(G))!==null;){m=f;const O=E[0],T=(E=X.exec(O))!==null?E[1]:"";for(q.push(T);(E=ee.exec(O))!==null;){let he=0,ce=0;const p=E[0];for(;(E=P.exec(p))!==null;)v.x=parseFloat(E[1]),v.y=parseFloat(E[2]),v.z=parseFloat(E[3]),ce++;for(;(E=se.exec(p))!==null;)u.push(parseFloat(E[1]),parseFloat(E[2]),parseFloat(E[3])),R.push(v.x,v.y,v.z),he++,f++;ce!==1&&console.error("THREE.STLLoader: Something isn't right with the normal of face number "+K),he!==3&&console.error("THREE.STLLoader: Something isn't right with the vertices of face number "+K),K++}const A=m,Y=f-m;V.userData.groupNames=q,V.addGroup(A,Y,y),y++}return V.setAttribute("position",new ke(u,3)),V.setAttribute("normal",new ke(R,3)),V}function I(G){return typeof G!="string"?new TextDecoder().decode(G):G}function N(G){if(typeof G=="string"){const V=new Uint8Array(G.length);for(let J=0;J<G.length;J++)V[J]=G.charCodeAt(J)&255;return V.buffer||V}else return G}const z=N(n);return a(z)?w(z):_(I(n))}}class jt extends Qi{constructor(n){super(n)}parse(n){function a(p){switch(p.image_type){case ee:case M:if(p.colormap_length>256||p.colormap_size!==24||p.colormap_type!==1)throw new Error("THREE.TGALoader: Invalid type colormap data for indexed type.");break;case X:case K:case se:case P:if(p.colormap_type)throw new Error("THREE.TGALoader: Invalid type colormap data for colormap type.");break;case J:throw new Error("THREE.TGALoader: No data.");default:throw new Error("THREE.TGALoader: Invalid type "+p.image_type)}if(p.width<=0||p.height<=0)throw new Error("THREE.TGALoader: Invalid image size.");if(p.pixel_size!==8&&p.pixel_size!==16&&p.pixel_size!==24&&p.pixel_size!==32)throw new Error("THREE.TGALoader: Invalid pixel size "+p.pixel_size)}function o(p,oe,W,ne,de){let te,re;const B=W.pixel_size>>3,H=W.width*W.height*B;if(oe&&(re=de.subarray(ne,ne+=W.colormap_length*(W.colormap_size>>3))),p){te=new Uint8Array(H);let j,x,D,ae=0;const ge=new Uint8Array(B);for(;ae<H;)if(j=de[ne++],x=(j&127)+1,j&128){for(D=0;D<B;++D)ge[D]=de[ne++];for(D=0;D<x;++D)te.set(ge,ae+D*B);ae+=B*x}else{for(x*=B,D=0;D<x;++D)te[ae+D]=de[ne++];ae+=x}}else te=de.subarray(ne,ne+=oe?W.width*W.height:H);return{pixel_data:te,palettes:re}}function w(p,oe,W,ne,de,te,re,B,H){const j=H;let x,D=0,ae,ge;const Ae=O.width;for(ge=oe;ge!==ne;ge+=W)for(ae=de;ae!==re;ae+=te,D++)x=B[D],p[(ae+Ae*ge)*4+3]=255,p[(ae+Ae*ge)*4+2]=j[x*3+0],p[(ae+Ae*ge)*4+1]=j[x*3+1],p[(ae+Ae*ge)*4+0]=j[x*3+2];return p}function _(p,oe,W,ne,de,te,re,B){let H,j=0,x,D;const ae=O.width;for(D=oe;D!==ne;D+=W)for(x=de;x!==re;x+=te,j+=2)H=B[j+0]+(B[j+1]<<8),p[(x+ae*D)*4+0]=(H&31744)>>7,p[(x+ae*D)*4+1]=(H&992)>>2,p[(x+ae*D)*4+2]=(H&31)<<3,p[(x+ae*D)*4+3]=H&32768?0:255;return p}function I(p,oe,W,ne,de,te,re,B){let H=0,j,x;const D=O.width;for(x=oe;x!==ne;x+=W)for(j=de;j!==re;j+=te,H+=3)p[(j+D*x)*4+3]=255,p[(j+D*x)*4+2]=B[H+0],p[(j+D*x)*4+1]=B[H+1],p[(j+D*x)*4+0]=B[H+2];return p}function N(p,oe,W,ne,de,te,re,B){let H=0,j,x;const D=O.width;for(x=oe;x!==ne;x+=W)for(j=de;j!==re;j+=te,H+=4)p[(j+D*x)*4+2]=B[H+0],p[(j+D*x)*4+1]=B[H+1],p[(j+D*x)*4+0]=B[H+2],p[(j+D*x)*4+3]=B[H+3];return p}function z(p,oe,W,ne,de,te,re,B){let H,j=0,x,D;const ae=O.width;for(D=oe;D!==ne;D+=W)for(x=de;x!==re;x+=te,j++)H=B[j],p[(x+ae*D)*4+0]=H,p[(x+ae*D)*4+1]=H,p[(x+ae*D)*4+2]=H,p[(x+ae*D)*4+3]=255;return p}function G(p,oe,W,ne,de,te,re,B){let H=0,j,x;const D=O.width;for(x=oe;x!==ne;x+=W)for(j=de;j!==re;j+=te,H+=2)p[(j+D*x)*4+0]=B[H+0],p[(j+D*x)*4+1]=B[H+0],p[(j+D*x)*4+2]=B[H+0],p[(j+D*x)*4+3]=B[H+1];return p}function V(p,oe,W,ne,de){let te,re,B,H,j,x;switch((O.flags&u)>>R){default:case E:te=0,B=1,j=oe,re=0,H=1,x=W;break;case q:te=0,B=1,j=oe,re=W-1,H=-1,x=-1;break;case y:te=oe-1,B=-1,j=-1,re=0,H=1,x=W;break;case v:te=oe-1,B=-1,j=-1,re=W-1,H=-1,x=-1;break}if(Y)switch(O.pixel_size){case 8:z(p,re,H,x,te,B,j,ne);break;case 16:G(p,re,H,x,te,B,j,ne);break;default:throw new Error("THREE.TGALoader: Format not supported.")}else switch(O.pixel_size){case 8:w(p,re,H,x,te,B,j,ne,de);break;case 16:_(p,re,H,x,te,B,j,ne);break;case 24:I(p,re,H,x,te,B,j,ne);break;case 32:N(p,re,H,x,te,B,j,ne);break;default:throw new Error("THREE.TGALoader: Format not supported.")}return p}const J=0,ee=1,X=2,K=3,M=9,se=10,P=11,u=48,R=4,q=0,v=1,E=2,y=3;if(n.length<19)throw new Error("THREE.TGALoader: Not enough data to contain header.");let m=0;const f=new Uint8Array(n),O={id_length:f[m++],colormap_type:f[m++],image_type:f[m++],colormap_index:f[m++]|f[m++]<<8,colormap_length:f[m++]|f[m++]<<8,colormap_size:f[m++],origin:[f[m++]|f[m++]<<8,f[m++]|f[m++]<<8],width:f[m++]|f[m++]<<8,height:f[m++]|f[m++]<<8,pixel_size:f[m++],flags:f[m++]};if(a(O),O.id_length+m>n.length)throw new Error("THREE.TGALoader: No data.");m+=O.id_length;let T=!1,A=!1,Y=!1;switch(O.image_type){case M:T=!0,A=!0;break;case ee:A=!0;break;case se:T=!0;break;case X:break;case P:T=!0,Y=!0;break;case K:Y=!0;break}const he=new Uint8Array(O.width*O.height*4),ce=o(T,A,O,m,f);return V(he,O.width,O.height,ce.pixel_data,ce.palettes),{data:he,width:O.width,height:O.height,flipY:!0,generateMipmaps:!0,minFilter:Zi}}}class An extends tt{load(n,a,o,w){const _=this,I=_.path===""?Gt.extractUrlBase(n):_.path,N=new Ht(_.manager);N.setPath(_.path),N.setRequestHeader(_.requestHeader),N.setWithCredentials(_.withCredentials),N.load(n,function(z){try{a(_.parse(z,I))}catch(G){w?w(G):console.error(G),_.manager.itemError(n)}},o,w)}parse(n,a){function o(t,e){const s=[],i=t.childNodes;for(let r=0,l=i.length;r<l;r++){const c=i[r];c.nodeName===e&&s.push(c)}return s}function w(t){if(t.length===0)return[];const e=t.trim().split(/\s+/),s=new Array(e.length);for(let i=0,r=e.length;i<r;i++)s[i]=e[i];return s}function _(t){if(t.length===0)return[];const e=t.trim().split(/\s+/),s=new Array(e.length);for(let i=0,r=e.length;i<r;i++)s[i]=parseFloat(e[i]);return s}function I(t){if(t.length===0)return[];const e=t.trim().split(/\s+/),s=new Array(e.length);for(let i=0,r=e.length;i<r;i++)s[i]=parseInt(e[i]);return s}function N(t){return t.substring(1)}function z(){return"three_default_"+Xi++}function G(t){return Object.keys(t).length===0}function V(t){return{unit:J(o(t,"unit")[0]),upAxis:ee(o(t,"up_axis")[0])}}function J(t){return t!==void 0&&t.hasAttribute("meter")===!0?parseFloat(t.getAttribute("meter")):1}function ee(t){return t!==void 0?t.textContent:"Y_UP"}function X(t,e,s,i){const r=o(t,e)[0];if(r!==void 0){const l=o(r,s);for(let c=0;c<l.length;c++)i(l[c])}}function K(t,e){for(const s in t){const i=t[s];i.build=e(t[s])}}function M(t,e){return t.build!==void 0||(t.build=e(t)),t.build}function se(t){const e={sources:{},samplers:{},channels:{}};let s=!1;for(let i=0,r=t.childNodes.length;i<r;i++){const l=t.childNodes[i];if(l.nodeType!==1)continue;let c;switch(l.nodeName){case"source":c=l.getAttribute("id"),e.sources[c]=Be(l);break;case"sampler":c=l.getAttribute("id"),e.samplers[c]=P(l);break;case"channel":c=l.getAttribute("target"),e.channels[c]=u(l);break;case"animation":se(l),s=!0;break;default:console.log(l)}}s===!1&&(U.animations[t.getAttribute("id")||Re.generateUUID()]=e)}function P(t){const e={inputs:{}};for(let s=0,i=t.childNodes.length;s<i;s++){const r=t.childNodes[s];if(r.nodeType===1)switch(r.nodeName){case"input":const l=N(r.getAttribute("source")),c=r.getAttribute("semantic");e.inputs[c]=l;break}}return e}function u(t){const e={};let i=t.getAttribute("target").split("/");const r=i.shift();let l=i.shift();const c=l.indexOf("(")!==-1,b=l.indexOf(".")!==-1;if(b)i=l.split("."),l=i.shift(),e.member=i.shift();else if(c){const h=l.split("(");l=h.shift();for(let g=0;g<h.length;g++)h[g]=parseInt(h[g].replace(/\)/,""));e.indices=h}return e.id=r,e.sid=l,e.arraySyntax=c,e.memberSyntax=b,e.sampler=N(t.getAttribute("source")),e}function R(t){const e=[],s=t.channels,i=t.samplers,r=t.sources;for(const l in s)if(s.hasOwnProperty(l)){const c=s[l],b=i[c.sampler],h=b.inputs.INPUT,g=b.inputs.OUTPUT,L=r[h],d=r[g],C=v(c,L,d);O(C,e)}return e}function q(t){return M(U.animations[t],R)}function v(t,e,s){const i=U.nodes[t.id],r=Ne(i.id),l=i.transforms[t.sid],c=i.matrix.clone().transpose();let b,h,g,L,d,C;const k={};switch(l){case"matrix":for(g=0,L=e.array.length;g<L;g++)if(b=e.array[g],h=g*s.stride,k[b]===void 0&&(k[b]={}),t.arraySyntax===!0){const le=s.array[h],ie=t.indices[0]+4*t.indices[1];k[b][ie]=le}else for(d=0,C=s.stride;d<C;d++)k[b][d]=s.array[h+d];break;case"translate":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',l);break;case"rotate":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',l);break;case"scale":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',l);break}const S=E(k,c);return{name:r.uuid,keyframes:S}}function E(t,e){const s=[];for(const r in t)s.push({time:parseFloat(r),value:t[r]});s.sort(i);for(let r=0;r<16;r++)T(s,r,e.elements[r]);return s;function i(r,l){return r.time-l.time}}const y=new pe,m=new pe,f=new ot;function O(t,e){const s=t.keyframes,i=t.name,r=[],l=[],c=[],b=[];for(let h=0,g=s.length;h<g;h++){const L=s[h],d=L.time,C=L.value;me.fromArray(C).transpose(),me.decompose(y,f,m),r.push(d),l.push(y.x,y.y,y.z),c.push(f.x,f.y,f.z,f.w),b.push(m.x,m.y,m.z)}return l.length>0&&e.push(new Mt(i+".position",r,l)),c.length>0&&e.push(new ln(i+".quaternion",r,c)),b.length>0&&e.push(new Mt(i+".scale",r,b)),e}function T(t,e,s){let i,r=!0,l,c;for(l=0,c=t.length;l<c;l++)i=t[l],i.value[e]===void 0?i.value[e]=null:r=!1;if(r===!0)for(l=0,c=t.length;l<c;l++)i=t[l],i.value[e]=s;else A(t,e)}function A(t,e){let s,i;for(let r=0,l=t.length;r<l;r++){const c=t[r];if(c.value[e]===null){if(s=Y(t,r,e),i=he(t,r,e),s===null){c.value[e]=i.value[e];continue}if(i===null){c.value[e]=s.value[e];continue}ce(c,s,i,e)}}}function Y(t,e,s){for(;e>=0;){const i=t[e];if(i.value[s]!==null)return i;e--}return null}function he(t,e,s){for(;e<t.length;){const i=t[e];if(i.value[s]!==null)return i;e++}return null}function ce(t,e,s,i){if(s.time-e.time===0){t.value[i]=e.value[i];return}t.value[i]=(t.time-e.time)*(s.value[i]-e.value[i])/(s.time-e.time)+e.value[i]}function p(t){const e={name:t.getAttribute("id")||"default",start:parseFloat(t.getAttribute("start")||0),end:parseFloat(t.getAttribute("end")||0),animations:[]};for(let s=0,i=t.childNodes.length;s<i;s++){const r=t.childNodes[s];if(r.nodeType===1)switch(r.nodeName){case"instance_animation":e.animations.push(N(r.getAttribute("url")));break}}U.clips[t.getAttribute("id")]=e}function oe(t){const e=[],s=t.name,i=t.end-t.start||-1,r=t.animations;for(let l=0,c=r.length;l<c;l++){const b=q(r[l]);for(let h=0,g=b.length;h<g;h++)e.push(b[h])}return new $t(s,i,e)}function W(t){return M(U.clips[t],oe)}function ne(t){const e={};for(let s=0,i=t.childNodes.length;s<i;s++){const r=t.childNodes[s];if(r.nodeType===1)switch(r.nodeName){case"skin":e.id=N(r.getAttribute("source")),e.skin=de(r);break;case"morph":e.id=N(r.getAttribute("source")),console.warn("THREE.ColladaLoader: Morph target animation not supported yet.");break}}U.controllers[t.getAttribute("id")]=e}function de(t){const e={sources:{}};for(let s=0,i=t.childNodes.length;s<i;s++){const r=t.childNodes[s];if(r.nodeType===1)switch(r.nodeName){case"bind_shape_matrix":e.bindShapeMatrix=_(r.textContent);break;case"source":const l=r.getAttribute("id");e.sources[l]=Be(r);break;case"joints":e.joints=te(r);break;case"vertex_weights":e.vertexWeights=re(r);break}}return e}function te(t){const e={inputs:{}};for(let s=0,i=t.childNodes.length;s<i;s++){const r=t.childNodes[s];if(r.nodeType===1)switch(r.nodeName){case"input":const l=r.getAttribute("semantic"),c=N(r.getAttribute("source"));e.inputs[l]=c;break}}return e}function re(t){const e={inputs:{}};for(let s=0,i=t.childNodes.length;s<i;s++){const r=t.childNodes[s];if(r.nodeType===1)switch(r.nodeName){case"input":const l=r.getAttribute("semantic"),c=N(r.getAttribute("source")),b=parseInt(r.getAttribute("offset"));e.inputs[l]={id:c,offset:b};break;case"vcount":e.vcount=I(r.textContent);break;case"v":e.v=I(r.textContent);break}}return e}function B(t){const e={id:t.id},s=U.geometries[e.id];return t.skin!==void 0&&(e.skin=H(t.skin),s.sources.skinIndices=e.skin.indices,s.sources.skinWeights=e.skin.weights),e}function H(t){const s={joints:[],indices:{array:[],stride:4},weights:{array:[],stride:4}},i=t.sources,r=t.vertexWeights,l=r.vcount,c=r.v,b=r.inputs.JOINT.offset,h=r.inputs.WEIGHT.offset,g=t.sources[t.joints.inputs.JOINT],L=t.sources[t.joints.inputs.INV_BIND_MATRIX],d=i[r.inputs.WEIGHT.id].array;let C=0,k,S,$;for(k=0,$=l.length;k<$;k++){const ie=l[k],Q=[];for(S=0;S<ie;S++){const Z=c[C+b],xe=c[C+h],fe=d[xe];Q.push({index:Z,weight:fe}),C+=2}for(Q.sort(le),S=0;S<4;S++){const Z=Q[S];Z!==void 0?(s.indices.array.push(Z.index),s.weights.array.push(Z.weight)):(s.indices.array.push(0),s.weights.array.push(0))}}for(t.bindShapeMatrix?s.bindMatrix=new we().fromArray(t.bindShapeMatrix).transpose():s.bindMatrix=new we().identity(),k=0,$=g.array.length;k<$;k++){const ie=g.array[k],Q=new we().fromArray(L.array,k*L.stride).transpose();s.joints.push({name:ie,boneInverse:Q})}return s;function le(ie,Q){return Q.weight-ie.weight}}function j(t){return M(U.controllers[t],B)}function x(t){const e={init_from:o(t,"init_from")[0].textContent};U.images[t.getAttribute("id")]=e}function D(t){return t.build!==void 0?t.build:t.init_from}function ae(t){const e=U.images[t];return e!==void 0?M(e,D):(console.warn("THREE.ColladaLoader: Couldn't find image with ID:",t),null)}function ge(t){const e={};for(let s=0,i=t.childNodes.length;s<i;s++){const r=t.childNodes[s];if(r.nodeType===1)switch(r.nodeName){case"profile_COMMON":e.profile=Ae(r);break}}U.effects[t.getAttribute("id")]=e}function Ae(t){const e={surfaces:{},samplers:{}};for(let s=0,i=t.childNodes.length;s<i;s++){const r=t.childNodes[s];if(r.nodeType===1)switch(r.nodeName){case"newparam":Xt(r,e);break;case"technique":e.technique=Zt(r);break;case"extra":e.extra=dt(r);break}}return e}function Xt(t,e){const s=t.getAttribute("sid");for(let i=0,r=t.childNodes.length;i<r;i++){const l=t.childNodes[i];if(l.nodeType===1)switch(l.nodeName){case"surface":e.surfaces[s]=Kt(l);break;case"sampler2D":e.samplers[s]=Qt(l);break}}}function Kt(t){const e={};for(let s=0,i=t.childNodes.length;s<i;s++){const r=t.childNodes[s];if(r.nodeType===1)switch(r.nodeName){case"init_from":e.init_from=r.textContent;break}}return e}function Qt(t){const e={};for(let s=0,i=t.childNodes.length;s<i;s++){const r=t.childNodes[s];if(r.nodeType===1)switch(r.nodeName){case"source":e.source=r.textContent;break}}return e}function Zt(t){const e={};for(let s=0,i=t.childNodes.length;s<i;s++){const r=t.childNodes[s];if(r.nodeType===1)switch(r.nodeName){case"constant":case"lambert":case"blinn":case"phong":e.type=r.nodeName,e.parameters=ei(r);break;case"extra":e.extra=dt(r);break}}return e}function ei(t){const e={};for(let s=0,i=t.childNodes.length;s<i;s++){const r=t.childNodes[s];if(r.nodeType===1)switch(r.nodeName){case"emission":case"diffuse":case"specular":case"bump":case"ambient":case"shininess":case"transparency":e[r.nodeName]=lt(r);break;case"transparent":e[r.nodeName]={opaque:r.hasAttribute("opaque")?r.getAttribute("opaque"):"A_ONE",data:lt(r)};break}}return e}function lt(t){const e={};for(let s=0,i=t.childNodes.length;s<i;s++){const r=t.childNodes[s];if(r.nodeType===1)switch(r.nodeName){case"color":e[r.nodeName]=_(r.textContent);break;case"float":e[r.nodeName]=parseFloat(r.textContent);break;case"texture":e[r.nodeName]={id:r.getAttribute("texture"),extra:ct(r)};break}}return e}function ct(t){const e={technique:{}};for(let s=0,i=t.childNodes.length;s<i;s++){const r=t.childNodes[s];if(r.nodeType===1)switch(r.nodeName){case"extra":ti(r,e);break}}return e}function ti(t,e){for(let s=0,i=t.childNodes.length;s<i;s++){const r=t.childNodes[s];if(r.nodeType===1)switch(r.nodeName){case"technique":ii(r,e);break}}}function ii(t,e){for(let s=0,i=t.childNodes.length;s<i;s++){const r=t.childNodes[s];if(r.nodeType===1)switch(r.nodeName){case"repeatU":case"repeatV":case"offsetU":case"offsetV":e.technique[r.nodeName]=parseFloat(r.textContent);break;case"wrapU":case"wrapV":r.textContent.toUpperCase()==="TRUE"?e.technique[r.nodeName]=1:r.textContent.toUpperCase()==="FALSE"?e.technique[r.nodeName]=0:e.technique[r.nodeName]=parseInt(r.textContent);break;case"bump":e[r.nodeName]=ut(r);break}}}function dt(t){const e={};for(let s=0,i=t.childNodes.length;s<i;s++){const r=t.childNodes[s];if(r.nodeType===1)switch(r.nodeName){case"technique":e.technique=ni(r);break}}return e}function ni(t){const e={};for(let s=0,i=t.childNodes.length;s<i;s++){const r=t.childNodes[s];if(r.nodeType===1)switch(r.nodeName){case"double_sided":e[r.nodeName]=parseInt(r.textContent);break;case"bump":e[r.nodeName]=ut(r);break}}return e}function ut(t){const e={};for(let s=0,i=t.childNodes.length;s<i;s++){const r=t.childNodes[s];if(r.nodeType===1)switch(r.nodeName){case"texture":e[r.nodeName]={id:r.getAttribute("texture"),texcoord:r.getAttribute("texcoord"),extra:ct(r)};break}}return e}function ht(t){return t}function si(t){return M(U.effects[t],ht)}function ri(t){const e={name:t.getAttribute("name")};for(let s=0,i=t.childNodes.length;s<i;s++){const r=t.childNodes[s];if(r.nodeType===1)switch(r.nodeName){case"instance_effect":e.url=N(r.getAttribute("url"));break}}U.materials[t.getAttribute("id")]=e}function oi(t){let e,s=t.slice((t.lastIndexOf(".")-1>>>0)+2);switch(s=s.toLowerCase(),s){case"tga":e=We;break;default:e=Tt}return e}function pt(t){const e=si(t.url),s=e.profile.technique;let i;switch(s.type){case"phong":case"blinn":i=new $e;break;case"lambert":i=new en;break;default:i=new Rt;break}i.name=t.name||"";function r(h,g=null){const L=e.profile.samplers[h.id];let d=null;if(L!==void 0){const C=e.profile.surfaces[L.source];d=ae(C.init_from)}else console.warn("THREE.ColladaLoader: Undefined sampler. Access image directly (see #12530)."),d=ae(h.id);if(d!==null){const C=oi(d);if(C!==void 0){const k=C.load(d),S=h.extra;if(S!==void 0&&S.technique!==void 0&&G(S.technique)===!1){const $=S.technique;k.wrapS=$.wrapU?Oe:Vt,k.wrapT=$.wrapV?Oe:Vt,k.offset.set($.offsetU||0,$.offsetV||0),k.repeat.set($.repeatU||1,$.repeatV||1)}else k.wrapS=Oe,k.wrapT=Oe;return g!==null&&(k.colorSpace=g),k}else return console.warn("THREE.ColladaLoader: Loader for texture %s not found.",d),null}else return console.warn("THREE.ColladaLoader: Couldn't create texture with ID:",h.id),null}const l=s.parameters;for(const h in l){const g=l[h];switch(h){case"diffuse":g.color&&i.color.fromArray(g.color),g.texture&&(i.map=r(g.texture,ye));break;case"specular":g.color&&i.specular&&i.specular.fromArray(g.color),g.texture&&(i.specularMap=r(g.texture));break;case"bump":g.texture&&(i.normalMap=r(g.texture));break;case"ambient":g.texture&&(i.lightMap=r(g.texture,ye));break;case"shininess":g.float&&i.shininess&&(i.shininess=g.float);break;case"emission":g.color&&i.emissive&&i.emissive.fromArray(g.color),g.texture&&(i.emissiveMap=r(g.texture,ye));break}}Ie.colorSpaceToWorking(i.color,ye),i.specular&&Ie.colorSpaceToWorking(i.specular,ye),i.emissive&&Ie.colorSpaceToWorking(i.emissive,ye);let c=l.transparent,b=l.transparency;if(b===void 0&&c&&(b={float:1}),c===void 0&&b&&(c={opaque:"A_ONE",data:{color:[1,1,1,1]}}),c&&b)if(c.data.texture)i.transparent=!0;else{const h=c.data.color;switch(c.opaque){case"A_ONE":i.opacity=h[3]*b.float;break;case"RGB_ZERO":i.opacity=1-h[0]*b.float;break;case"A_ZERO":i.opacity=1-h[3]*b.float;break;case"RGB_ONE":i.opacity=h[0]*b.float;break;default:console.warn('THREE.ColladaLoader: Invalid opaque type "%s" of transparent tag.',c.opaque)}i.opacity<1&&(i.transparent=!0)}if(s.extra!==void 0&&s.extra.technique!==void 0){const h=s.extra.technique;for(const g in h){const L=h[g];switch(g){case"double_sided":i.side=L===1?nn:sn;break;case"bump":i.normalMap=r(L.texture),i.normalScale=new tn(1,1);break}}}return i}function ai(t){return M(U.materials[t],pt)}function li(t){const e={name:t.getAttribute("name")};for(let s=0,i=t.childNodes.length;s<i;s++){const r=t.childNodes[s];if(r.nodeType===1)switch(r.nodeName){case"optics":e.optics=ci(r);break}}U.cameras[t.getAttribute("id")]=e}function ci(t){for(let e=0;e<t.childNodes.length;e++){const s=t.childNodes[e];switch(s.nodeName){case"technique_common":return di(s)}}return{}}function di(t){const e={};for(let s=0;s<t.childNodes.length;s++){const i=t.childNodes[s];switch(i.nodeName){case"perspective":case"orthographic":e.technique=i.nodeName,e.parameters=ui(i);break}}return e}function ui(t){const e={};for(let s=0;s<t.childNodes.length;s++){const i=t.childNodes[s];switch(i.nodeName){case"xfov":case"yfov":case"xmag":case"ymag":case"znear":case"zfar":case"aspect_ratio":e[i.nodeName]=parseFloat(i.textContent);break}}return e}function ft(t){let e;switch(t.optics.technique){case"perspective":e=new nt(t.optics.parameters.yfov,t.optics.parameters.aspect_ratio,t.optics.parameters.znear,t.optics.parameters.zfar);break;case"orthographic":let s=t.optics.parameters.ymag,i=t.optics.parameters.xmag;const r=t.optics.parameters.aspect_ratio;i=i===void 0?s*r:i,s=s===void 0?i/r:s,i*=.5,s*=.5,e=new rn(-i,i,s,-s,t.optics.parameters.znear,t.optics.parameters.zfar);break;default:e=new nt;break}return e.name=t.name||"",e}function hi(t){const e=U.cameras[t];return e!==void 0?M(e,ft):(console.warn("THREE.ColladaLoader: Couldn't find camera with ID:",t),null)}function pi(t){let e={};for(let s=0,i=t.childNodes.length;s<i;s++){const r=t.childNodes[s];if(r.nodeType===1)switch(r.nodeName){case"technique_common":e=fi(r);break}}U.lights[t.getAttribute("id")]=e}function fi(t){const e={};for(let s=0,i=t.childNodes.length;s<i;s++){const r=t.childNodes[s];if(r.nodeType===1)switch(r.nodeName){case"directional":case"point":case"spot":case"ambient":e.technique=r.nodeName,e.parameters=mi(r)}}return e}function mi(t){const e={};for(let s=0,i=t.childNodes.length;s<i;s++){const r=t.childNodes[s];if(r.nodeType===1)switch(r.nodeName){case"color":const l=_(r.textContent);e.color=new qe().fromArray(l),Ie.colorSpaceToWorking(e.color,ye);break;case"falloff_angle":e.falloffAngle=parseFloat(r.textContent);break;case"quadratic_attenuation":const c=parseFloat(r.textContent);e.distance=c?Math.sqrt(1/c):0;break}}return e}function mt(t){let e;switch(t.technique){case"directional":e=new Ge;break;case"point":e=new an;break;case"spot":e=new on;break;case"ambient":e=new Bt;break}return t.parameters.color&&e.color.copy(t.parameters.color),t.parameters.distance&&(e.distance=t.parameters.distance),e}function gi(t){const e=U.lights[t];return e!==void 0?M(e,mt):(console.warn("THREE.ColladaLoader: Couldn't find light with ID:",t),null)}function bi(t){const e={name:t.getAttribute("name"),sources:{},vertices:{},primitives:[]},s=o(t,"mesh")[0];if(s!==void 0){for(let i=0;i<s.childNodes.length;i++){const r=s.childNodes[i];if(r.nodeType!==1)continue;const l=r.getAttribute("id");switch(r.nodeName){case"source":e.sources[l]=Be(r);break;case"vertices":e.vertices=wi(r);break;case"polygons":console.warn("THREE.ColladaLoader: Unsupported primitive type: ",r.nodeName);break;case"lines":case"linestrips":case"polylist":case"triangles":e.primitives.push(yi(r));break;default:console.log(r)}}U.geometries[t.getAttribute("id")]=e}}function Be(t){const e={array:[],stride:3};for(let s=0;s<t.childNodes.length;s++){const i=t.childNodes[s];if(i.nodeType===1)switch(i.nodeName){case"float_array":e.array=_(i.textContent);break;case"Name_array":e.array=w(i.textContent);break;case"technique_common":const r=o(i,"accessor")[0];r!==void 0&&(e.stride=parseInt(r.getAttribute("stride")));break}}return e}function wi(t){const e={};for(let s=0;s<t.childNodes.length;s++){const i=t.childNodes[s];i.nodeType===1&&(e[i.getAttribute("semantic")]=N(i.getAttribute("source")))}return e}function yi(t){const e={type:t.nodeName,material:t.getAttribute("material"),count:parseInt(t.getAttribute("count")),inputs:{},stride:0,hasUV:!1};for(let s=0,i=t.childNodes.length;s<i;s++){const r=t.childNodes[s];if(r.nodeType===1)switch(r.nodeName){case"input":const l=N(r.getAttribute("source")),c=r.getAttribute("semantic"),b=parseInt(r.getAttribute("offset")),h=parseInt(r.getAttribute("set")),g=h>0?c+h:c;e.inputs[g]={id:l,offset:b},e.stride=Math.max(e.stride,b+1),c==="TEXCOORD"&&(e.hasUV=!0);break;case"vcount":e.vcount=I(r.textContent);break;case"p":e.p=I(r.textContent);break}}return e}function _i(t){const e={};for(let s=0;s<t.length;s++){const i=t[s];e[i.type]===void 0&&(e[i.type]=[]),e[i.type].push(i)}return e}function xi(t){let e=0;for(let s=0,i=t.length;s<i;s++)t[s].hasUV===!0&&e++;e>0&&e<t.length&&(t.uvsNeedsFix=!0)}function gt(t){const e={},s=t.sources,i=t.vertices,r=t.primitives;if(r.length===0)return{};const l=_i(r);for(const c in l){const b=l[c];xi(b),e[c]=ki(b,s,i)}return e}function ki(t,e,s){const i={},r={array:[],stride:0},l={array:[],stride:0},c={array:[],stride:0},b={array:[],stride:0},h={array:[],stride:0},g={array:[],stride:4},L={array:[],stride:4},d=new it,C=[];let k=0;for(let S=0;S<t.length;S++){const $=t[S],le=$.inputs;let ie=0;switch($.type){case"lines":case"linestrips":ie=$.count*2;break;case"triangles":ie=$.count*3;break;case"polylist":for(let Q=0;Q<$.count;Q++){const Z=$.vcount[Q];switch(Z){case 3:ie+=3;break;case 4:ie+=6;break;default:ie+=(Z-2)*3;break}}break;default:console.warn("THREE.ColladaLoader: Unknown primitive type:",$.type)}d.addGroup(k,ie,S),k+=ie,$.material&&C.push($.material);for(const Q in le){const Z=le[Q];switch(Q){case"VERTEX":for(const xe in s){const fe=s[xe];switch(xe){case"POSITION":const Ce=r.array.length;if(be($,e[fe],Z.offset,r.array),r.stride=e[fe].stride,e.skinWeights&&e.skinIndices&&(be($,e.skinIndices,Z.offset,g.array),be($,e.skinWeights,Z.offset,L.array)),$.hasUV===!1&&t.uvsNeedsFix===!0){const Ki=(r.array.length-Ce)/r.stride;for(let Ft=0;Ft<Ki;Ft++)c.array.push(0,0)}break;case"NORMAL":be($,e[fe],Z.offset,l.array),l.stride=e[fe].stride;break;case"COLOR":be($,e[fe],Z.offset,h.array),h.stride=e[fe].stride;break;case"TEXCOORD":be($,e[fe],Z.offset,c.array),c.stride=e[fe].stride;break;case"TEXCOORD1":be($,e[fe],Z.offset,b.array),c.stride=e[fe].stride;break;default:console.warn('THREE.ColladaLoader: Semantic "%s" not handled in geometry build process.',xe)}}break;case"NORMAL":be($,e[Z.id],Z.offset,l.array),l.stride=e[Z.id].stride;break;case"COLOR":be($,e[Z.id],Z.offset,h.array,!0),h.stride=e[Z.id].stride;break;case"TEXCOORD":be($,e[Z.id],Z.offset,c.array),c.stride=e[Z.id].stride;break;case"TEXCOORD1":be($,e[Z.id],Z.offset,b.array),b.stride=e[Z.id].stride;break}}}return r.array.length>0&&d.setAttribute("position",new ke(r.array,r.stride)),l.array.length>0&&d.setAttribute("normal",new ke(l.array,l.stride)),h.array.length>0&&d.setAttribute("color",new ke(h.array,h.stride)),c.array.length>0&&d.setAttribute("uv",new ke(c.array,c.stride)),b.array.length>0&&d.setAttribute("uv1",new ke(b.array,b.stride)),g.array.length>0&&d.setAttribute("skinIndex",new ke(g.array,g.stride)),L.array.length>0&&d.setAttribute("skinWeight",new ke(L.array,L.stride)),i.data=d,i.type=t[0].type,i.materialKeys=C,i}function be(t,e,s,i,r=!1){const l=t.p,c=t.stride,b=t.vcount;function h(d){let C=l[d+s]*L;const k=C+L;for(;C<k;C++)i.push(g[C]);if(r){const S=i.length-L-1;Se.setRGB(i[S+0],i[S+1],i[S+2],ye),i[S+0]=Se.r,i[S+1]=Se.g,i[S+2]=Se.b}}const g=e.array,L=e.stride;if(t.vcount!==void 0){let d=0;for(let C=0,k=b.length;C<k;C++){const S=b[C];if(S===4){const $=d+c*0,le=d+c*1,ie=d+c*2,Q=d+c*3;h($),h(le),h(Q),h(le),h(ie),h(Q)}else if(S===3){const $=d+c*0,le=d+c*1,ie=d+c*2;h($),h(le),h(ie)}else if(S>4)for(let $=1,le=S-2;$<=le;$++){const ie=d+c*0,Q=d+c*$,Z=d+c*($+1);h(ie),h(Q),h(Z)}d+=c*S}}else for(let d=0,C=l.length;d<C;d+=c)h(d)}function bt(t){return M(U.geometries[t],gt)}function vi(t){const e={name:t.getAttribute("name")||"",joints:{},links:[]};for(let s=0;s<t.childNodes.length;s++){const i=t.childNodes[s];if(i.nodeType===1)switch(i.nodeName){case"technique_common":Ni(i,e);break}}U.kinematicsModels[t.getAttribute("id")]=e}function Ai(t){return t.build!==void 0?t.build:t}function Ei(t){return M(U.kinematicsModels[t],Ai)}function Ni(t,e){for(let s=0;s<t.childNodes.length;s++){const i=t.childNodes[s];if(i.nodeType===1)switch(i.nodeName){case"joint":e.joints[i.getAttribute("sid")]=Ci(i);break;case"link":e.links.push(wt(i));break}}}function Ci(t){let e;for(let s=0;s<t.childNodes.length;s++){const i=t.childNodes[s];if(i.nodeType===1)switch(i.nodeName){case"prismatic":case"revolute":e=Ti(i);break}}return e}function Ti(t){const e={sid:t.getAttribute("sid"),name:t.getAttribute("name")||"",axis:new pe,limits:{min:0,max:0},type:t.nodeName,static:!1,zeroPosition:0,middlePosition:0};for(let s=0;s<t.childNodes.length;s++){const i=t.childNodes[s];if(i.nodeType===1)switch(i.nodeName){case"axis":const r=_(i.textContent);e.axis.fromArray(r);break;case"limits":const l=i.getElementsByTagName("max")[0],c=i.getElementsByTagName("min")[0];e.limits.max=parseFloat(l.textContent),e.limits.min=parseFloat(c.textContent);break}}return e.limits.min>=e.limits.max&&(e.static=!0),e.middlePosition=(e.limits.min+e.limits.max)/2,e}function wt(t){const e={sid:t.getAttribute("sid"),name:t.getAttribute("name")||"",attachments:[],transforms:[]};for(let s=0;s<t.childNodes.length;s++){const i=t.childNodes[s];if(i.nodeType===1)switch(i.nodeName){case"attachment_full":e.attachments.push(Li(i));break;case"matrix":case"translate":case"rotate":e.transforms.push(yt(i));break}}return e}function Li(t){const e={joint:t.getAttribute("joint").split("/").pop(),transforms:[],links:[]};for(let s=0;s<t.childNodes.length;s++){const i=t.childNodes[s];if(i.nodeType===1)switch(i.nodeName){case"link":e.links.push(wt(i));break;case"matrix":case"translate":case"rotate":e.transforms.push(yt(i));break}}return e}function yt(t){const e={type:t.nodeName},s=_(t.textContent);switch(e.type){case"matrix":e.obj=new we,e.obj.fromArray(s).transpose();break;case"translate":e.obj=new pe,e.obj.fromArray(s);break;case"rotate":e.obj=new pe,e.obj.fromArray(s),e.angle=Re.degToRad(s[3]);break}return e}function Fi(t){const e={name:t.getAttribute("name")||"",rigidBodies:{}};for(let s=0;s<t.childNodes.length;s++){const i=t.childNodes[s];if(i.nodeType===1)switch(i.nodeName){case"rigid_body":e.rigidBodies[i.getAttribute("name")]={},Ri(i,e.rigidBodies[i.getAttribute("name")]);break}}U.physicsModels[t.getAttribute("id")]=e}function Ri(t,e){for(let s=0;s<t.childNodes.length;s++){const i=t.childNodes[s];if(i.nodeType===1)switch(i.nodeName){case"technique_common":$i(i,e);break}}}function $i(t,e){for(let s=0;s<t.childNodes.length;s++){const i=t.childNodes[s];if(i.nodeType===1)switch(i.nodeName){case"inertia":e.inertia=_(i.textContent);break;case"mass":e.mass=_(i.textContent)[0];break}}}function Mi(t){const e={bindJointAxis:[]};for(let s=0;s<t.childNodes.length;s++){const i=t.childNodes[s];if(i.nodeType===1)switch(i.nodeName){case"bind_joint_axis":e.bindJointAxis.push(Si(i));break}}U.kinematicsScenes[N(t.getAttribute("url"))]=e}function Si(t){const e={target:t.getAttribute("target").split("/").pop()};for(let s=0;s<t.childNodes.length;s++){const i=t.childNodes[s];if(i.nodeType===1)switch(i.nodeName){case"axis":const r=i.getElementsByTagName("param")[0];e.axis=r.textContent;const l=e.axis.split("inst_").pop().split("axis")[0];e.jointIndex=l.substring(0,l.length-1);break}}return e}function Vi(t){return t.build!==void 0?t.build:t}function ji(t){return M(U.kinematicsScenes[t],Vi)}function Ii(){const t=Object.keys(U.kinematicsModels)[0],e=Object.keys(U.kinematicsScenes)[0],s=Object.keys(U.visualScenes)[0];if(t===void 0||e===void 0)return;const i=Ei(t),r=ji(e),l=Et(s),c=r.bindJointAxis,b={};for(let L=0,d=c.length;L<d;L++){const C=c[L],k=ue.querySelector('[sid="'+C.target+'"]');if(k){const S=k.parentElement;h(C.jointIndex,S)}}function h(L,d){const C=d.getAttribute("name"),k=i.joints[L];l.traverse(function(S){S.name===C&&(b[L]={object:S,transforms:Oi(d),joint:k,position:k.zeroPosition})})}const g=new we;Lt={joints:i&&i.joints,getJointValue:function(L){const d=b[L];if(d)return d.position;console.warn("THREE.ColladaLoader: Joint "+L+" doesn't exist.")},setJointValue:function(L,d){const C=b[L];if(C){const k=C.joint;if(d>k.limits.max||d<k.limits.min)console.warn("THREE.ColladaLoader: Joint "+L+" value "+d+" outside of limits (min: "+k.limits.min+", max: "+k.limits.max+").");else if(k.static)console.warn("THREE.ColladaLoader: Joint "+L+" is static.");else{const S=C.object,$=k.axis,le=C.transforms;me.identity();for(let ie=0;ie<le.length;ie++){const Q=le[ie];if(Q.sid&&Q.sid.indexOf(L)!==-1)switch(k.type){case"revolute":me.multiply(g.makeRotationAxis($,Re.degToRad(d)));break;case"prismatic":me.multiply(g.makeTranslation($.x*d,$.y*d,$.z*d));break;default:console.warn("THREE.ColladaLoader: Unknown joint type: "+k.type);break}else switch(Q.type){case"matrix":me.multiply(Q.obj);break;case"translate":me.multiply(g.makeTranslation(Q.obj.x,Q.obj.y,Q.obj.z));break;case"scale":me.scale(Q.obj);break;case"rotate":me.multiply(g.makeRotationAxis(Q.obj,Q.angle));break}}S.matrix.copy(me),S.matrix.decompose(S.position,S.quaternion,S.scale),b[L].position=d}}else console.log("THREE.ColladaLoader: "+L+" does not exist.")}}}function Oi(t){const e=[],s=ue.querySelector('[id="'+t.id+'"]');for(let i=0;i<s.childNodes.length;i++){const r=s.childNodes[i];if(r.nodeType!==1)continue;let l,c;switch(r.nodeName){case"matrix":l=_(r.textContent);const b=new we().fromArray(l).transpose();e.push({sid:r.getAttribute("sid"),type:r.nodeName,obj:b});break;case"translate":case"scale":l=_(r.textContent),c=new pe().fromArray(l),e.push({sid:r.getAttribute("sid"),type:r.nodeName,obj:c});break;case"rotate":l=_(r.textContent),c=new pe().fromArray(l);const h=Re.degToRad(l[3]);e.push({sid:r.getAttribute("sid"),type:r.nodeName,obj:c,angle:h});break}}return e}function Di(t){const e=t.getElementsByTagName("node");for(let s=0;s<e.length;s++){const i=e[s];i.hasAttribute("id")===!1&&i.setAttribute("id",z())}}const me=new we,Ee=new pe;function Je(t){const e={name:t.getAttribute("name")||"",type:t.getAttribute("type"),id:t.getAttribute("id"),sid:t.getAttribute("sid"),matrix:new we,nodes:[],instanceCameras:[],instanceControllers:[],instanceLights:[],instanceGeometries:[],instanceNodes:[],transforms:{}};for(let s=0;s<t.childNodes.length;s++){const i=t.childNodes[s];if(i.nodeType!==1)continue;let r;switch(i.nodeName){case"node":e.nodes.push(i.getAttribute("id")),Je(i);break;case"instance_camera":e.instanceCameras.push(N(i.getAttribute("url")));break;case"instance_controller":e.instanceControllers.push(_t(i));break;case"instance_light":e.instanceLights.push(N(i.getAttribute("url")));break;case"instance_geometry":e.instanceGeometries.push(_t(i));break;case"instance_node":e.instanceNodes.push(N(i.getAttribute("url")));break;case"matrix":r=_(i.textContent),e.matrix.multiply(me.fromArray(r).transpose()),e.transforms[i.getAttribute("sid")]=i.nodeName;break;case"translate":r=_(i.textContent),Ee.fromArray(r),e.matrix.multiply(me.makeTranslation(Ee.x,Ee.y,Ee.z)),e.transforms[i.getAttribute("sid")]=i.nodeName;break;case"rotate":r=_(i.textContent);const l=Re.degToRad(r[3]);e.matrix.multiply(me.makeRotationAxis(Ee.fromArray(r),l)),e.transforms[i.getAttribute("sid")]=i.nodeName;break;case"scale":r=_(i.textContent),e.matrix.scale(Ee.fromArray(r)),e.transforms[i.getAttribute("sid")]=i.nodeName;break;case"extra":break;default:console.log(i)}}return vt(e.id)?console.warn("THREE.ColladaLoader: There is already a node with ID %s. Exclude current node from further processing.",e.id):U.nodes[e.id]=e,e}function _t(t){const e={id:N(t.getAttribute("url")),materials:{},skeletons:[]};for(let s=0;s<t.childNodes.length;s++){const i=t.childNodes[s];switch(i.nodeName){case"bind_material":const r=i.getElementsByTagName("instance_material");for(let l=0;l<r.length;l++){const c=r[l],b=c.getAttribute("symbol"),h=c.getAttribute("target");e.materials[b]=N(h)}break;case"skeleton":e.skeletons.push(N(i.textContent));break}}return e}function Ui(t,e){const s=[],i=[];let r,l,c;for(r=0;r<t.length;r++){const g=t[r];let L;if(vt(g))L=Ne(g),xt(L,e,s);else if(zi(g)){const C=U.visualScenes[g].children;for(let k=0;k<C.length;k++){const S=C[k];if(S.type==="JOINT"){const $=Ne(S.id);xt($,e,s)}}}else console.error("THREE.ColladaLoader: Unable to find root bone of skeleton with ID:",g)}for(r=0;r<e.length;r++)for(l=0;l<s.length;l++)if(c=s[l],c.bone.name===e[r].name){i[r]=c,c.processed=!0;break}for(r=0;r<s.length;r++)c=s[r],c.processed===!1&&(i.push(c),c.processed=!0);const b=[],h=[];for(r=0;r<i.length;r++)c=i[r],b.push(c.bone),h.push(c.boneInverse);return new pn(b,h)}function xt(t,e,s){t.traverse(function(i){if(i.isBone===!0){let r;for(let l=0;l<e.length;l++){const c=e[l];if(c.name===i.name){r=c.boneInverse;break}}r===void 0&&(r=new we),s.push({bone:i,boneInverse:r,processed:!1})}})}function Pi(t){const e=[],s=t.matrix,i=t.nodes,r=t.type,l=t.instanceCameras,c=t.instanceControllers,b=t.instanceLights,h=t.instanceGeometries,g=t.instanceNodes;for(let d=0,C=i.length;d<C;d++)e.push(Ne(i[d]));for(let d=0,C=l.length;d<C;d++){const k=hi(l[d]);k!==null&&e.push(k.clone())}for(let d=0,C=c.length;d<C;d++){const k=c[d],S=j(k.id),$=bt(S.id),le=kt($,k.materials),ie=k.skeletons,Q=S.skin.joints,Z=Ui(ie,Q);for(let xe=0,fe=le.length;xe<fe;xe++){const Ce=le[xe];Ce.isSkinnedMesh&&(Ce.bind(Z,S.skin.bindMatrix),Ce.normalizeSkinWeights()),e.push(Ce)}}for(let d=0,C=b.length;d<C;d++){const k=gi(b[d]);k!==null&&e.push(k.clone())}for(let d=0,C=h.length;d<C;d++){const k=h[d],S=bt(k.id),$=kt(S,k.materials);for(let le=0,ie=$.length;le<ie;le++)e.push($[le])}for(let d=0,C=g.length;d<C;d++)e.push(Ne(g[d]).clone());let L;if(i.length===0&&e.length===1)L=e[0];else{L=r==="JOINT"?new cn:new st;for(let d=0;d<e.length;d++)L.add(e[d])}return L.name=r==="JOINT"?t.sid:t.name,L.matrix.copy(s),L.matrix.decompose(L.position,L.quaternion,L.scale),L}const Hi=new Rt({name:tt.DEFAULT_MATERIAL_NAME,color:16711935});function Gi(t,e){const s=[];for(let i=0,r=t.length;i<r;i++){const l=e[t[i]];l===void 0?(console.warn("THREE.ColladaLoader: Material with key %s not found. Apply fallback material.",t[i]),s.push(Hi)):s.push(ai(l))}return s}function kt(t,e){const s=[];for(const i in t){const r=t[i],l=Gi(r.materialKeys,e);if(l.length===0&&(i==="lines"||i==="linestrips"?l.push(new St):l.push(new $e)),i==="lines"||i==="linestrips")for(let g=0,L=l.length;g<L;g++){const d=l[g];if(d.isMeshPhongMaterial===!0||d.isMeshLambertMaterial===!0){const C=new St;C.color.copy(d.color),C.opacity=d.opacity,C.transparent=d.transparent,l[g]=C}}const c=r.data.attributes.skinIndex!==void 0,b=l.length===1?l[0]:l;let h;switch(i){case"lines":h=new hn(r.data,b);break;case"linestrips":h=new un(r.data,b);break;case"triangles":case"polylist":c?h=new dn(r.data,b):h=new Fe(r.data,b);break}s.push(h)}return s}function vt(t){return U.nodes[t]!==void 0}function Ne(t){return M(U.nodes[t],Pi)}function qi(t){const e={name:t.getAttribute("name"),children:[]};Di(t);const s=o(t,"node");for(let i=0;i<s.length;i++)e.children.push(Je(s[i]));U.visualScenes[t.getAttribute("id")]=e}function At(t){const e=new st;e.name=t.name;const s=t.children;for(let i=0;i<s.length;i++){const r=s[i];e.add(Ne(r.id))}return e}function zi(t){return U.visualScenes[t]!==void 0}function Et(t){return M(U.visualScenes[t],At)}function Bi(t){const e=o(t,"instance_visual_scene")[0];return Et(N(e.getAttribute("url")))}function Ji(){const t=U.clips;if(G(t)===!0){if(G(U.animations)===!1){const e=[];for(const s in U.animations){const i=q(s);for(let r=0,l=i.length;r<l;r++)e.push(i[r])}Ve.push(new $t("default",-1,e))}}else for(const e in t)Ve.push(W(e))}function Yi(t){let e="";const s=[t];for(;s.length;){const i=s.shift();i.nodeType===Node.TEXT_NODE?e+=i.textContent:(e+=`
`,s.push(...i.childNodes))}return e.trim()}if(n.length===0)return{scene:new qt};const Nt=new DOMParser().parseFromString(n,"application/xml"),ue=o(Nt,"COLLADA")[0],Ye=Nt.getElementsByTagName("parsererror")[0];if(Ye!==void 0){const t=o(Ye,"div")[0];let e;return t?e=t.textContent:e=Yi(Ye),console.error(`THREE.ColladaLoader: Failed to parse collada file.
`,e),null}const Wi=ue.getAttribute("version");console.debug("THREE.ColladaLoader: File version",Wi);const Ct=V(o(ue,"asset")[0]),Tt=new zt(this.manager);Tt.setPath(this.resourcePath||a).setCrossOrigin(this.crossOrigin);let We;jt&&(We=new jt(this.manager),We.setPath(this.resourcePath||a));const Se=new qe,Ve=[];let Lt={},Xi=0;const U={animations:{},clips:{},controllers:{},images:{},effects:{},materials:{},cameras:{},lights:{},geometries:{},nodes:{},visualScenes:{},kinematicsModels:{},physicsModels:{},kinematicsScenes:{}};X(ue,"library_animations","animation",se),X(ue,"library_animation_clips","animation_clip",p),X(ue,"library_controllers","controller",ne),X(ue,"library_images","image",x),X(ue,"library_effects","effect",ge),X(ue,"library_materials","material",ri),X(ue,"library_cameras","camera",li),X(ue,"library_lights","light",pi),X(ue,"library_geometries","geometry",bi),X(ue,"library_nodes","node",Je),X(ue,"library_visual_scenes","visual_scene",qi),X(ue,"library_kinematics_models","kinematics_model",vi),X(ue,"library_physics_models","physics_model",Fi),X(ue,"scene","instance_kinematics_scene",Mi),K(U.animations,R),K(U.clips,oe),K(U.controllers,B),K(U.images,D),K(U.effects,ht),K(U.materials,pt),K(U.cameras,ft),K(U.lights,mt),K(U.geometries,gt),K(U.visualScenes,At),Ji(),Ii();const je=Bi(o(ue,"scene")[0]);return je.animations=Ve,Ct.upAxis==="Z_UP"&&(console.warn("THREE.ColladaLoader: You are loading an asset with a Z-UP coordinate system. The loader just rotates the asset to transform it into Y-UP. The vertex data are not converted, see #24289."),je.rotation.set(-Math.PI/2,0,0)),je.scale.multiplyScalar(Ct.unit),{get animations(){return console.warn("THREE.ColladaLoader: Please access animations over scene.animations now."),Ve},kinematics:Lt,library:U,scene:je}}}const It=new pe,En=new Jt,De=new we,ve=new we,Ue=new ot,Pe=new pe(1,1,1),He=new pe;class ze extends fn{constructor(...n){super(...n),this.urdfNode=null,this.urdfName=""}copy(n,a){return super.copy(n,a),this.urdfNode=n.urdfNode,this.urdfName=n.urdfName,this}}class Nn extends ze{constructor(...n){super(...n),this.isURDFCollider=!0,this.type="URDFCollider"}}class Cn extends ze{constructor(...n){super(...n),this.isURDFVisual=!0,this.type="URDFVisual"}}class Yt extends ze{constructor(...n){super(...n),this.isURDFLink=!0,this.type="URDFLink"}}class Wt extends ze{get jointType(){return this._jointType}set jointType(n){if(this.jointType!==n)switch(this._jointType=n,this.matrixWorldNeedsUpdate=!0,n){case"fixed":this.jointValue=[];break;case"continuous":case"revolute":case"prismatic":this.jointValue=new Array(1).fill(0);break;case"planar":this.jointValue=new Array(3).fill(0),this.axis=new pe(0,0,1);break;case"floating":this.jointValue=new Array(6).fill(0);break}}get angle(){return this.jointValue[0]}constructor(...n){super(...n),this.isURDFJoint=!0,this.type="URDFJoint",this.jointValue=null,this.jointType="fixed",this.axis=new pe(1,0,0),this.limit={lower:0,upper:0},this.ignoreLimits=!1,this.origPosition=null,this.origQuaternion=null,this.mimicJoints=[]}copy(n,a){return super.copy(n,a),this.jointType=n.jointType,this.axis=n.axis.clone(),this.limit.lower=n.limit.lower,this.limit.upper=n.limit.upper,this.ignoreLimits=!1,this.jointValue=[...n.jointValue],this.origPosition=n.origPosition?n.origPosition.clone():null,this.origQuaternion=n.origQuaternion?n.origQuaternion.clone():null,this.mimicJoints=[...n.mimicJoints],this}setJointValue(...n){n=n.map(o=>o===null?null:parseFloat(o)),(!this.origPosition||!this.origQuaternion)&&(this.origPosition=this.position.clone(),this.origQuaternion=this.quaternion.clone());let a=!1;switch(this.mimicJoints.forEach(o=>{a=o.updateFromMimickedJoint(...n)||a}),this.jointType){case"fixed":return a;case"continuous":case"revolute":{let o=n[0];return o==null||o===this.jointValue[0]?a:(!this.ignoreLimits&&this.jointType==="revolute"&&(o=Math.min(this.limit.upper,o),o=Math.max(this.limit.lower,o)),this.quaternion.setFromAxisAngle(this.axis,o).premultiply(this.origQuaternion),this.jointValue[0]!==o?(this.jointValue[0]=o,this.matrixWorldNeedsUpdate=!0,!0):a)}case"prismatic":{let o=n[0];return o==null||o===this.jointValue[0]?a:(this.ignoreLimits||(o=Math.min(this.limit.upper,o),o=Math.max(this.limit.lower,o)),this.position.copy(this.origPosition),It.copy(this.axis).applyEuler(this.rotation),this.position.addScaledVector(It,o),this.jointValue[0]!==o?(this.jointValue[0]=o,this.matrixWorldNeedsUpdate=!0,!0):a)}case"floating":return this.jointValue.every((o,w)=>n[w]===o||n[w]===null)?a:(this.jointValue[0]=n[0]!==null?n[0]:this.jointValue[0],this.jointValue[1]=n[1]!==null?n[1]:this.jointValue[1],this.jointValue[2]=n[2]!==null?n[2]:this.jointValue[2],this.jointValue[3]=n[3]!==null?n[3]:this.jointValue[3],this.jointValue[4]=n[4]!==null?n[4]:this.jointValue[4],this.jointValue[5]=n[5]!==null?n[5]:this.jointValue[5],ve.compose(this.origPosition,this.origQuaternion,Pe),Ue.setFromEuler(En.set(this.jointValue[3],this.jointValue[4],this.jointValue[5],"XYZ")),He.set(this.jointValue[0],this.jointValue[1],this.jointValue[2]),De.compose(He,Ue,Pe),ve.premultiply(De),this.position.setFromMatrixPosition(ve),this.rotation.setFromRotationMatrix(ve),this.matrixWorldNeedsUpdate=!0,!0);case"planar":return this.jointValue.every((o,w)=>n[w]===o||n[w]===null)?a:(this.jointValue[0]=n[0]!==null?n[0]:this.jointValue[0],this.jointValue[1]=n[1]!==null?n[1]:this.jointValue[1],this.jointValue[2]=n[2]!==null?n[2]:this.jointValue[2],ve.compose(this.origPosition,this.origQuaternion,Pe),Ue.setFromAxisAngle(this.axis,this.jointValue[2]),He.set(this.jointValue[0],this.jointValue[1],0),De.compose(He,Ue,Pe),ve.premultiply(De),this.position.setFromMatrixPosition(ve),this.rotation.setFromRotationMatrix(ve),this.matrixWorldNeedsUpdate=!0,!0)}return a}}class Ot extends Wt{constructor(...n){super(...n),this.type="URDFMimicJoint",this.mimicJoint=null,this.offset=0,this.multiplier=1}updateFromMimickedJoint(...n){const a=n.map(o=>o*this.multiplier+this.offset);return super.setJointValue(...a)}copy(n,a){return super.copy(n,a),this.mimicJoint=n.mimicJoint,this.offset=n.offset,this.multiplier=n.multiplier,this}}class Tn extends Yt{constructor(...n){super(...n),this.isURDFRobot=!0,this.urdfNode=null,this.urdfRobotNode=null,this.robotName=null,this.links=null,this.joints=null,this.colliders=null,this.visual=null,this.frames=null}copy(n,a){super.copy(n,a),this.urdfRobotNode=n.urdfRobotNode,this.robotName=n.robotName,this.links={},this.joints={},this.colliders={},this.visual={},this.traverse(o=>{o.isURDFJoint&&o.urdfName in n.joints&&(this.joints[o.urdfName]=o),o.isURDFLink&&o.urdfName in n.links&&(this.links[o.urdfName]=o),o.isURDFCollider&&o.urdfName in n.colliders&&(this.colliders[o.urdfName]=o),o.isURDFVisual&&o.urdfName in n.visual&&(this.visual[o.urdfName]=o)});for(const o in this.joints)this.joints[o].mimicJoints=this.joints[o].mimicJoints.map(w=>this.joints[w.name]);return this.frames={...this.colliders,...this.visual,...this.links,...this.joints},this}getFrame(n){return this.frames[n]}setJointValue(n,...a){const o=this.joints[n];return o?o.setJointValue(...a):!1}setJointValues(n){let a=!1;for(const o in n){const w=n[o];Array.isArray(w)?a=this.setJointValue(o,...w)||a:a=this.setJointValue(o,w)||a}return a}}const Qe=new ot,Dt=new Jt;function Te(F){return F?F.trim().split(/\s+/g).map(n=>parseFloat(n)):[0,0,0]}function Ut(F,n,a=!1){a||F.rotation.set(0,0,0),Dt.set(n[0],n[1],n[2],"ZYX"),Qe.setFromEuler(Dt),Qe.multiply(F.quaternion),F.quaternion.copy(Qe)}class Ln{constructor(n){this.manager=n||mn,this.loadMeshCb=this.defaultMeshLoader.bind(this),this.parseVisual=!0,this.parseCollision=!1,this.packages="",this.workingPath="",this.fetchOptions={}}loadAsync(n){return new Promise((a,o)=>{this.load(n,a,null,o)})}load(n,a,o,w){const _=this.manager,I=Gt.extractUrlBase(n),N=this.manager.resolveURL(n);_.itemStart(N),fetch(N,this.fetchOptions).then(z=>{if(z.ok)return o&&o(null),z.text();throw new Error(`URDFLoader: Failed to load url '${N}' with error code ${z.status} : ${z.statusText}.`)}).then(z=>{const G=this.parse(z,this.workingPath||I);a(G),_.itemEnd(N)}).catch(z=>{w?w(z):console.error("URDFLoader: Error loading file.",z),_.itemError(N),_.itemEnd(N)})}parse(n,a=this.workingPath){const o=this.packages,w=this.loadMeshCb,_=this.parseVisual,I=this.parseCollision,N=this.manager,z={},G={},V={};function J(u){if(!/^package:\/\//.test(u))return a?a+u:u;const[R,q]=u.replace(/^package:\/\//,"").split(/\/(.+)/);if(typeof o=="string")return o.endsWith(R)?o+"/"+q:o+"/"+R+"/"+q;if(o instanceof Function)return o(R)+"/"+q;if(typeof o=="object")return R in o?o[R]+"/"+q:(console.error(`URDFLoader : ${R} not found in provided package list.`),null)}function ee(u){let R;u instanceof Document?R=[...u.children]:u instanceof Element?R=[u]:R=[...new DOMParser().parseFromString(u,"text/xml").children];const q=R.filter(v=>v.nodeName==="robot").pop();return X(q)}function X(u){const R=[...u.children],q=R.filter(T=>T.nodeName.toLowerCase()==="link"),v=R.filter(T=>T.nodeName.toLowerCase()==="joint"),E=R.filter(T=>T.nodeName.toLowerCase()==="material"),y=new Tn;y.robotName=u.getAttribute("name"),y.urdfRobotNode=u,E.forEach(T=>{const A=T.getAttribute("name");V[A]=se(T)});const m={},f={};q.forEach(T=>{const A=T.getAttribute("name"),Y=u.querySelector(`child[link="${A}"]`)===null;z[A]=M(T,m,f,Y?y:null)}),v.forEach(T=>{const A=T.getAttribute("name");G[A]=K(T)}),y.joints=G,y.links=z,y.colliders=f,y.visual=m;const O=Object.values(G);return O.forEach(T=>{T instanceof Ot&&G[T.mimicJoint].mimicJoints.push(T)}),O.forEach(T=>{const A=new Set,Y=he=>{if(A.has(he))throw new Error("URDFLoader: Detected an infinite loop of mimic joints.");A.add(he),he.mimicJoints.forEach(ce=>{Y(ce)})};Y(T)}),y.frames={...f,...m,...z,...G},y}function K(u){const R=[...u.children],q=u.getAttribute("type");let v;const E=R.find(A=>A.nodeName.toLowerCase()==="mimic");E?(v=new Ot,v.mimicJoint=E.getAttribute("joint"),v.multiplier=parseFloat(E.getAttribute("multiplier")||1),v.offset=parseFloat(E.getAttribute("offset")||0)):v=new Wt,v.urdfNode=u,v.name=u.getAttribute("name"),v.urdfName=v.name,v.jointType=q;let y=null,m=null,f=[0,0,0],O=[0,0,0];R.forEach(A=>{const Y=A.nodeName.toLowerCase();Y==="origin"?(f=Te(A.getAttribute("xyz")),O=Te(A.getAttribute("rpy"))):Y==="child"?m=z[A.getAttribute("link")]:Y==="parent"?y=z[A.getAttribute("link")]:Y==="limit"&&(v.limit.lower=parseFloat(A.getAttribute("lower")||v.limit.lower),v.limit.upper=parseFloat(A.getAttribute("upper")||v.limit.upper))}),y.add(v),v.add(m),Ut(v,O),v.position.set(f[0],f[1],f[2]);const T=R.filter(A=>A.nodeName.toLowerCase()==="axis")[0];if(T){const A=T.getAttribute("xyz").split(/\s+/g).map(Y=>parseFloat(Y));v.axis=new pe(A[0],A[1],A[2]),v.axis.normalize()}return v}function M(u,R,q,v=null){v===null&&(v=new Yt);const E=[...u.children];return v.name=u.getAttribute("name"),v.urdfName=v.name,v.urdfNode=u,_&&E.filter(m=>m.nodeName.toLowerCase()==="visual").forEach(m=>{const f=P(m,V);if(v.add(f),m.hasAttribute("name")){const O=m.getAttribute("name");f.name=O,f.urdfName=O,R[O]=f}}),I&&E.filter(m=>m.nodeName.toLowerCase()==="collision").forEach(m=>{const f=P(m);if(v.add(f),m.hasAttribute("name")){const O=m.getAttribute("name");f.name=O,f.urdfName=O,q[O]=f}}),v}function se(u){const R=[...u.children],q=new $e;return q.name=u.getAttribute("name")||"",R.forEach(v=>{const E=v.nodeName.toLowerCase();if(E==="color"){const y=v.getAttribute("rgba").split(/\s/g).map(m=>parseFloat(m));q.color.setRGB(y[0],y[1],y[2]),q.opacity=y[3],q.transparent=y[3]<1,q.depthWrite=!q.transparent}else if(E==="texture"){const y=v.getAttribute("filename");if(y){const m=new zt(N),f=J(y);q.map=m.load(f),q.map.colorSpace=ye}}}),q}function P(u,R={}){const q=u.nodeName.toLowerCase()==="collision",v=[...u.children];let E=null;const y=v.filter(f=>f.nodeName.toLowerCase()==="material")[0];if(y){const f=y.getAttribute("name");f&&f in R?E=R[f]:E=se(y)}else E=new $e;const m=q?new Nn:new Cn;return m.urdfNode=u,v.forEach(f=>{const O=f.nodeName.toLowerCase();if(O==="geometry"){const T=f.children[0].nodeName.toLowerCase();if(T==="mesh"){const A=f.children[0].getAttribute("filename"),Y=J(A);if(Y!==null){const he=f.children[0].getAttribute("scale");if(he){const ce=Te(he);m.scale.set(ce[0],ce[1],ce[2])}w(Y,N,(ce,p)=>{p?console.error("URDFLoader: Error loading mesh.",p):ce&&(ce instanceof Fe&&(ce.material=E),ce.position.set(0,0,0),ce.quaternion.identity(),m.add(ce))})}}else if(T==="box"){const A=new Fe;A.geometry=new gn(1,1,1),A.material=E;const Y=Te(f.children[0].getAttribute("size"));A.scale.set(Y[0],Y[1],Y[2]),m.add(A)}else if(T==="sphere"){const A=new Fe;A.geometry=new bn(1,30,30),A.material=E;const Y=parseFloat(f.children[0].getAttribute("radius"))||0;A.scale.set(Y,Y,Y),m.add(A)}else if(T==="cylinder"){const A=new Fe;A.geometry=new wn(1,1,1,30),A.material=E;const Y=parseFloat(f.children[0].getAttribute("radius"))||0,he=parseFloat(f.children[0].getAttribute("length"))||0;A.scale.set(Y,he,Y),A.rotation.set(Math.PI/2,0,0),m.add(A)}}else if(O==="origin"){const T=Te(f.getAttribute("xyz")),A=Te(f.getAttribute("rpy"));m.position.set(T[0],T[1],T[2]),m.rotation.set(0,0,0),Ut(m,A)}}),m}return ee(n)}defaultMeshLoader(n,a,o){/\.stl$/i.test(n)?new vn(a).load(n,_=>{const I=new Fe(_,new $e);o(I)}):/\.dae$/i.test(n)?new An(a).load(n,_=>o(_.scene)):console.warn(`URDFLoader: Could not load model at ${n}.
No loader available`)}}/**
 * lil-gui
 * https://lil-gui.georgealways.com
 * @version 0.21.0
 * @author George Michael Brower
 * @license MIT
 */class _e{constructor(n,a,o,w,_="div"){this.parent=n,this.object=a,this.property=o,this._disabled=!1,this._hidden=!1,this.initialValue=this.getValue(),this.domElement=document.createElement(_),this.domElement.classList.add("lil-controller"),this.domElement.classList.add(w),this.$name=document.createElement("div"),this.$name.classList.add("lil-name"),_e.nextNameID=_e.nextNameID||0,this.$name.id=`lil-gui-name-${++_e.nextNameID}`,this.$widget=document.createElement("div"),this.$widget.classList.add("lil-widget"),this.$disable=this.$widget,this.domElement.appendChild(this.$name),this.domElement.appendChild(this.$widget),this.domElement.addEventListener("keydown",I=>I.stopPropagation()),this.domElement.addEventListener("keyup",I=>I.stopPropagation()),this.parent.children.push(this),this.parent.controllers.push(this),this.parent.$children.appendChild(this.domElement),this._listenCallback=this._listenCallback.bind(this),this.name(o)}name(n){return this._name=n,this.$name.textContent=n,this}onChange(n){return this._onChange=n,this}_callOnChange(){this.parent._callOnChange(this),this._onChange!==void 0&&this._onChange.call(this,this.getValue()),this._changed=!0}onFinishChange(n){return this._onFinishChange=n,this}_callOnFinishChange(){this._changed&&(this.parent._callOnFinishChange(this),this._onFinishChange!==void 0&&this._onFinishChange.call(this,this.getValue())),this._changed=!1}reset(){return this.setValue(this.initialValue),this._callOnFinishChange(),this}enable(n=!0){return this.disable(!n)}disable(n=!0){return n===this._disabled?this:(this._disabled=n,this.domElement.classList.toggle("lil-disabled",n),this.$disable.toggleAttribute("disabled",n),this)}show(n=!0){return this._hidden=!n,this.domElement.style.display=this._hidden?"none":"",this}hide(){return this.show(!1)}options(n){const a=this.parent.add(this.object,this.property,n);return a.name(this._name),this.destroy(),a}min(n){return this}max(n){return this}step(n){return this}decimals(n){return this}listen(n=!0){return this._listening=n,this._listenCallbackID!==void 0&&(cancelAnimationFrame(this._listenCallbackID),this._listenCallbackID=void 0),this._listening&&this._listenCallback(),this}_listenCallback(){this._listenCallbackID=requestAnimationFrame(this._listenCallback);const n=this.save();n!==this._listenPrevValue&&this.updateDisplay(),this._listenPrevValue=n}getValue(){return this.object[this.property]}setValue(n){return this.getValue()!==n&&(this.object[this.property]=n,this._callOnChange(),this.updateDisplay()),this}updateDisplay(){return this}load(n){return this.setValue(n),this._callOnFinishChange(),this}save(){return this.getValue()}destroy(){this.listen(!1),this.parent.children.splice(this.parent.children.indexOf(this),1),this.parent.controllers.splice(this.parent.controllers.indexOf(this),1),this.parent.$children.removeChild(this.domElement)}}class Fn extends _e{constructor(n,a,o){super(n,a,o,"lil-boolean","label"),this.$input=document.createElement("input"),this.$input.setAttribute("type","checkbox"),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$widget.appendChild(this.$input),this.$input.addEventListener("change",()=>{this.setValue(this.$input.checked),this._callOnFinishChange()}),this.$disable=this.$input,this.updateDisplay()}updateDisplay(){return this.$input.checked=this.getValue(),this}}function rt(F){let n,a;return(n=F.match(/(#|0x)?([a-f0-9]{6})/i))?a=n[2]:(n=F.match(/rgb\(\s*(\d*)\s*,\s*(\d*)\s*,\s*(\d*)\s*\)/))?a=parseInt(n[1]).toString(16).padStart(2,0)+parseInt(n[2]).toString(16).padStart(2,0)+parseInt(n[3]).toString(16).padStart(2,0):(n=F.match(/^#?([a-f0-9])([a-f0-9])([a-f0-9])$/i))&&(a=n[1]+n[1]+n[2]+n[2]+n[3]+n[3]),a?"#"+a:!1}const Rn={isPrimitive:!0,match:F=>typeof F=="string",fromHexString:rt,toHexString:rt},Me={isPrimitive:!0,match:F=>typeof F=="number",fromHexString:F=>parseInt(F.substring(1),16),toHexString:F=>"#"+F.toString(16).padStart(6,0)},$n={isPrimitive:!1,match:F=>Array.isArray(F)||ArrayBuffer.isView(F),fromHexString(F,n,a=1){const o=Me.fromHexString(F);n[0]=(o>>16&255)/255*a,n[1]=(o>>8&255)/255*a,n[2]=(o&255)/255*a},toHexString([F,n,a],o=1){o=255/o;const w=F*o<<16^n*o<<8^a*o<<0;return Me.toHexString(w)}},Mn={isPrimitive:!1,match:F=>Object(F)===F,fromHexString(F,n,a=1){const o=Me.fromHexString(F);n.r=(o>>16&255)/255*a,n.g=(o>>8&255)/255*a,n.b=(o&255)/255*a},toHexString({r:F,g:n,b:a},o=1){o=255/o;const w=F*o<<16^n*o<<8^a*o<<0;return Me.toHexString(w)}},Sn=[Rn,Me,$n,Mn];function Vn(F){return Sn.find(n=>n.match(F))}class jn extends _e{constructor(n,a,o,w){super(n,a,o,"lil-color"),this.$input=document.createElement("input"),this.$input.setAttribute("type","color"),this.$input.setAttribute("tabindex",-1),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$text=document.createElement("input"),this.$text.setAttribute("type","text"),this.$text.setAttribute("spellcheck","false"),this.$text.setAttribute("aria-labelledby",this.$name.id),this.$display=document.createElement("div"),this.$display.classList.add("lil-display"),this.$display.appendChild(this.$input),this.$widget.appendChild(this.$display),this.$widget.appendChild(this.$text),this._format=Vn(this.initialValue),this._rgbScale=w,this._initialValueHexString=this.save(),this._textFocused=!1,this.$input.addEventListener("input",()=>{this._setValueFromHexString(this.$input.value)}),this.$input.addEventListener("blur",()=>{this._callOnFinishChange()}),this.$text.addEventListener("input",()=>{const _=rt(this.$text.value);_&&this._setValueFromHexString(_)}),this.$text.addEventListener("focus",()=>{this._textFocused=!0,this.$text.select()}),this.$text.addEventListener("blur",()=>{this._textFocused=!1,this.updateDisplay(),this._callOnFinishChange()}),this.$disable=this.$text,this.updateDisplay()}reset(){return this._setValueFromHexString(this._initialValueHexString),this}_setValueFromHexString(n){if(this._format.isPrimitive){const a=this._format.fromHexString(n);this.setValue(a)}else this._format.fromHexString(n,this.getValue(),this._rgbScale),this._callOnChange(),this.updateDisplay()}save(){return this._format.toHexString(this.getValue(),this._rgbScale)}load(n){return this._setValueFromHexString(n),this._callOnFinishChange(),this}updateDisplay(){return this.$input.value=this._format.toHexString(this.getValue(),this._rgbScale),this._textFocused||(this.$text.value=this.$input.value.substring(1)),this.$display.style.backgroundColor=this.$input.value,this}}class Ze extends _e{constructor(n,a,o){super(n,a,o,"lil-function"),this.$button=document.createElement("button"),this.$button.appendChild(this.$name),this.$widget.appendChild(this.$button),this.$button.addEventListener("click",w=>{w.preventDefault(),this.getValue().call(this.object),this._callOnChange()}),this.$button.addEventListener("touchstart",()=>{},{passive:!0}),this.$disable=this.$button}}class In extends _e{constructor(n,a,o,w,_,I){super(n,a,o,"lil-number"),this._initInput(),this.min(w),this.max(_);const N=I!==void 0;this.step(N?I:this._getImplicitStep(),N),this.updateDisplay()}decimals(n){return this._decimals=n,this.updateDisplay(),this}min(n){return this._min=n,this._onUpdateMinMax(),this}max(n){return this._max=n,this._onUpdateMinMax(),this}step(n,a=!0){return this._step=n,this._stepExplicit=a,this}updateDisplay(){const n=this.getValue();if(this._hasSlider){let a=(n-this._min)/(this._max-this._min);a=Math.max(0,Math.min(a,1)),this.$fill.style.width=a*100+"%"}return this._inputFocused||(this.$input.value=this._decimals===void 0?n:n.toFixed(this._decimals)),this}_initInput(){this.$input=document.createElement("input"),this.$input.setAttribute("type","text"),this.$input.setAttribute("aria-labelledby",this.$name.id),window.matchMedia("(pointer: coarse)").matches&&(this.$input.setAttribute("type","number"),this.$input.setAttribute("step","any")),this.$widget.appendChild(this.$input),this.$disable=this.$input;const a=()=>{let u=parseFloat(this.$input.value);isNaN(u)||(this._stepExplicit&&(u=this._snap(u)),this.setValue(this._clamp(u)))},o=u=>{const R=parseFloat(this.$input.value);isNaN(R)||(this._snapClampSetValue(R+u),this.$input.value=this.getValue())},w=u=>{u.key==="Enter"&&this.$input.blur(),u.code==="ArrowUp"&&(u.preventDefault(),o(this._step*this._arrowKeyMultiplier(u))),u.code==="ArrowDown"&&(u.preventDefault(),o(this._step*this._arrowKeyMultiplier(u)*-1))},_=u=>{this._inputFocused&&(u.preventDefault(),o(this._step*this._normalizeMouseWheel(u)))};let I=!1,N,z,G,V,J;const ee=5,X=u=>{N=u.clientX,z=G=u.clientY,I=!0,V=this.getValue(),J=0,window.addEventListener("mousemove",K),window.addEventListener("mouseup",M)},K=u=>{if(I){const R=u.clientX-N,q=u.clientY-z;Math.abs(q)>ee?(u.preventDefault(),this.$input.blur(),I=!1,this._setDraggingStyle(!0,"vertical")):Math.abs(R)>ee&&M()}if(!I){const R=u.clientY-G;J-=R*this._step*this._arrowKeyMultiplier(u),V+J>this._max?J=this._max-V:V+J<this._min&&(J=this._min-V),this._snapClampSetValue(V+J)}G=u.clientY},M=()=>{this._setDraggingStyle(!1,"vertical"),this._callOnFinishChange(),window.removeEventListener("mousemove",K),window.removeEventListener("mouseup",M)},se=()=>{this._inputFocused=!0},P=()=>{this._inputFocused=!1,this.updateDisplay(),this._callOnFinishChange()};this.$input.addEventListener("input",a),this.$input.addEventListener("keydown",w),this.$input.addEventListener("wheel",_,{passive:!1}),this.$input.addEventListener("mousedown",X),this.$input.addEventListener("focus",se),this.$input.addEventListener("blur",P)}_initSlider(){this._hasSlider=!0,this.$slider=document.createElement("div"),this.$slider.classList.add("lil-slider"),this.$fill=document.createElement("div"),this.$fill.classList.add("lil-fill"),this.$slider.appendChild(this.$fill),this.$widget.insertBefore(this.$slider,this.$input),this.domElement.classList.add("lil-has-slider");const n=(P,u,R,q,v)=>(P-u)/(R-u)*(v-q)+q,a=P=>{const u=this.$slider.getBoundingClientRect();let R=n(P,u.left,u.right,this._min,this._max);this._snapClampSetValue(R)},o=P=>{this._setDraggingStyle(!0),a(P.clientX),window.addEventListener("mousemove",w),window.addEventListener("mouseup",_)},w=P=>{a(P.clientX)},_=()=>{this._callOnFinishChange(),this._setDraggingStyle(!1),window.removeEventListener("mousemove",w),window.removeEventListener("mouseup",_)};let I=!1,N,z;const G=P=>{P.preventDefault(),this._setDraggingStyle(!0),a(P.touches[0].clientX),I=!1},V=P=>{P.touches.length>1||(this._hasScrollBar?(N=P.touches[0].clientX,z=P.touches[0].clientY,I=!0):G(P),window.addEventListener("touchmove",J,{passive:!1}),window.addEventListener("touchend",ee))},J=P=>{if(I){const u=P.touches[0].clientX-N,R=P.touches[0].clientY-z;Math.abs(u)>Math.abs(R)?G(P):(window.removeEventListener("touchmove",J),window.removeEventListener("touchend",ee))}else P.preventDefault(),a(P.touches[0].clientX)},ee=()=>{this._callOnFinishChange(),this._setDraggingStyle(!1),window.removeEventListener("touchmove",J),window.removeEventListener("touchend",ee)},X=this._callOnFinishChange.bind(this),K=400;let M;const se=P=>{if(Math.abs(P.deltaX)<Math.abs(P.deltaY)&&this._hasScrollBar)return;P.preventDefault();const R=this._normalizeMouseWheel(P)*this._step;this._snapClampSetValue(this.getValue()+R),this.$input.value=this.getValue(),clearTimeout(M),M=setTimeout(X,K)};this.$slider.addEventListener("mousedown",o),this.$slider.addEventListener("touchstart",V,{passive:!1}),this.$slider.addEventListener("wheel",se,{passive:!1})}_setDraggingStyle(n,a="horizontal"){this.$slider&&this.$slider.classList.toggle("lil-active",n),document.body.classList.toggle("lil-dragging",n),document.body.classList.toggle(`lil-${a}`,n)}_getImplicitStep(){return this._hasMin&&this._hasMax?(this._max-this._min)/1e3:.1}_onUpdateMinMax(){!this._hasSlider&&this._hasMin&&this._hasMax&&(this._stepExplicit||this.step(this._getImplicitStep(),!1),this._initSlider(),this.updateDisplay())}_normalizeMouseWheel(n){let{deltaX:a,deltaY:o}=n;return Math.floor(n.deltaY)!==n.deltaY&&n.wheelDelta&&(a=0,o=-n.wheelDelta/120,o*=this._stepExplicit?1:10),a+-o}_arrowKeyMultiplier(n){let a=this._stepExplicit?1:10;return n.shiftKey?a*=10:n.altKey&&(a/=10),a}_snap(n){let a=0;return this._hasMin?a=this._min:this._hasMax&&(a=this._max),n-=a,n=Math.round(n/this._step)*this._step,n+=a,n=parseFloat(n.toPrecision(15)),n}_clamp(n){return n<this._min&&(n=this._min),n>this._max&&(n=this._max),n}_snapClampSetValue(n){this.setValue(this._clamp(this._snap(n)))}get _hasScrollBar(){const n=this.parent.root.$children;return n.scrollHeight>n.clientHeight}get _hasMin(){return this._min!==void 0}get _hasMax(){return this._max!==void 0}}class On extends _e{constructor(n,a,o,w){super(n,a,o,"lil-option"),this.$select=document.createElement("select"),this.$select.setAttribute("aria-labelledby",this.$name.id),this.$display=document.createElement("div"),this.$display.classList.add("lil-display"),this.$select.addEventListener("change",()=>{this.setValue(this._values[this.$select.selectedIndex]),this._callOnFinishChange()}),this.$select.addEventListener("focus",()=>{this.$display.classList.add("lil-focus")}),this.$select.addEventListener("blur",()=>{this.$display.classList.remove("lil-focus")}),this.$widget.appendChild(this.$select),this.$widget.appendChild(this.$display),this.$disable=this.$select,this.options(w)}options(n){return this._values=Array.isArray(n)?n:Object.values(n),this._names=Array.isArray(n)?n:Object.keys(n),this.$select.replaceChildren(),this._names.forEach(a=>{const o=document.createElement("option");o.textContent=a,this.$select.appendChild(o)}),this.updateDisplay(),this}updateDisplay(){const n=this.getValue(),a=this._values.indexOf(n);return this.$select.selectedIndex=a,this.$display.textContent=a===-1?n:this._names[a],this}}class Dn extends _e{constructor(n,a,o){super(n,a,o,"lil-string"),this.$input=document.createElement("input"),this.$input.setAttribute("type","text"),this.$input.setAttribute("spellcheck","false"),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$input.addEventListener("input",()=>{this.setValue(this.$input.value)}),this.$input.addEventListener("keydown",w=>{w.code==="Enter"&&this.$input.blur()}),this.$input.addEventListener("blur",()=>{this._callOnFinishChange()}),this.$widget.appendChild(this.$input),this.$disable=this.$input,this.updateDisplay()}updateDisplay(){return this.$input.value=this.getValue(),this}}var Un=`.lil-gui {
  font-family: var(--font-family);
  font-size: var(--font-size);
  line-height: 1;
  font-weight: normal;
  font-style: normal;
  text-align: left;
  color: var(--text-color);
  user-select: none;
  -webkit-user-select: none;
  touch-action: manipulation;
  --background-color: #1f1f1f;
  --text-color: #ebebeb;
  --title-background-color: #111111;
  --title-text-color: #ebebeb;
  --widget-color: #424242;
  --hover-color: #4f4f4f;
  --focus-color: #595959;
  --number-color: #2cc9ff;
  --string-color: #a2db3c;
  --font-size: 11px;
  --input-font-size: 11px;
  --font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif;
  --font-family-mono: Menlo, Monaco, Consolas, "Droid Sans Mono", monospace;
  --padding: 4px;
  --spacing: 4px;
  --widget-height: 20px;
  --title-height: calc(var(--widget-height) + var(--spacing) * 1.25);
  --name-width: 45%;
  --slider-knob-width: 2px;
  --slider-input-width: 27%;
  --color-input-width: 27%;
  --slider-input-min-width: 45px;
  --color-input-min-width: 45px;
  --folder-indent: 7px;
  --widget-padding: 0 0 0 3px;
  --widget-border-radius: 2px;
  --checkbox-size: calc(0.75 * var(--widget-height));
  --scrollbar-width: 5px;
}
.lil-gui, .lil-gui * {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}
.lil-gui.lil-root {
  width: var(--width, 245px);
  display: flex;
  flex-direction: column;
  background: var(--background-color);
}
.lil-gui.lil-root > .lil-title {
  background: var(--title-background-color);
  color: var(--title-text-color);
}
.lil-gui.lil-root > .lil-children {
  overflow-x: hidden;
  overflow-y: auto;
}
.lil-gui.lil-root > .lil-children::-webkit-scrollbar {
  width: var(--scrollbar-width);
  height: var(--scrollbar-width);
  background: var(--background-color);
}
.lil-gui.lil-root > .lil-children::-webkit-scrollbar-thumb {
  border-radius: var(--scrollbar-width);
  background: var(--focus-color);
}
@media (pointer: coarse) {
  .lil-gui.lil-allow-touch-styles, .lil-gui.lil-allow-touch-styles .lil-gui {
    --widget-height: 28px;
    --padding: 6px;
    --spacing: 6px;
    --font-size: 13px;
    --input-font-size: 16px;
    --folder-indent: 10px;
    --scrollbar-width: 7px;
    --slider-input-min-width: 50px;
    --color-input-min-width: 65px;
  }
}
.lil-gui.lil-force-touch-styles, .lil-gui.lil-force-touch-styles .lil-gui {
  --widget-height: 28px;
  --padding: 6px;
  --spacing: 6px;
  --font-size: 13px;
  --input-font-size: 16px;
  --folder-indent: 10px;
  --scrollbar-width: 7px;
  --slider-input-min-width: 50px;
  --color-input-min-width: 65px;
}
.lil-gui.lil-auto-place, .lil-gui.autoPlace {
  max-height: 100%;
  position: fixed;
  top: 0;
  right: 15px;
  z-index: 1001;
}

.lil-controller {
  display: flex;
  align-items: center;
  padding: 0 var(--padding);
  margin: var(--spacing) 0;
}
.lil-controller.lil-disabled {
  opacity: 0.5;
}
.lil-controller.lil-disabled, .lil-controller.lil-disabled * {
  pointer-events: none !important;
}
.lil-controller > .lil-name {
  min-width: var(--name-width);
  flex-shrink: 0;
  white-space: pre;
  padding-right: var(--spacing);
  line-height: var(--widget-height);
}
.lil-controller .lil-widget {
  position: relative;
  display: flex;
  align-items: center;
  width: 100%;
  min-height: var(--widget-height);
}
.lil-controller.lil-string input {
  color: var(--string-color);
}
.lil-controller.lil-boolean {
  cursor: pointer;
}
.lil-controller.lil-color .lil-display {
  width: 100%;
  height: var(--widget-height);
  border-radius: var(--widget-border-radius);
  position: relative;
}
@media (hover: hover) {
  .lil-controller.lil-color .lil-display:hover:before {
    content: " ";
    display: block;
    position: absolute;
    border-radius: var(--widget-border-radius);
    border: 1px solid #fff9;
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
  }
}
.lil-controller.lil-color input[type=color] {
  opacity: 0;
  width: 100%;
  height: 100%;
  cursor: pointer;
}
.lil-controller.lil-color input[type=text] {
  margin-left: var(--spacing);
  font-family: var(--font-family-mono);
  min-width: var(--color-input-min-width);
  width: var(--color-input-width);
  flex-shrink: 0;
}
.lil-controller.lil-option select {
  opacity: 0;
  position: absolute;
  width: 100%;
  max-width: 100%;
}
.lil-controller.lil-option .lil-display {
  position: relative;
  pointer-events: none;
  border-radius: var(--widget-border-radius);
  height: var(--widget-height);
  line-height: var(--widget-height);
  max-width: 100%;
  overflow: hidden;
  word-break: break-all;
  padding-left: 0.55em;
  padding-right: 1.75em;
  background: var(--widget-color);
}
@media (hover: hover) {
  .lil-controller.lil-option .lil-display.lil-focus {
    background: var(--focus-color);
  }
}
.lil-controller.lil-option .lil-display.lil-active {
  background: var(--focus-color);
}
.lil-controller.lil-option .lil-display:after {
  font-family: "lil-gui";
  content: "";
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  padding-right: 0.375em;
}
.lil-controller.lil-option .lil-widget,
.lil-controller.lil-option select {
  cursor: pointer;
}
@media (hover: hover) {
  .lil-controller.lil-option .lil-widget:hover .lil-display {
    background: var(--hover-color);
  }
}
.lil-controller.lil-number input {
  color: var(--number-color);
}
.lil-controller.lil-number.lil-has-slider input {
  margin-left: var(--spacing);
  width: var(--slider-input-width);
  min-width: var(--slider-input-min-width);
  flex-shrink: 0;
}
.lil-controller.lil-number .lil-slider {
  width: 100%;
  height: var(--widget-height);
  background: var(--widget-color);
  border-radius: var(--widget-border-radius);
  padding-right: var(--slider-knob-width);
  overflow: hidden;
  cursor: ew-resize;
  touch-action: pan-y;
}
@media (hover: hover) {
  .lil-controller.lil-number .lil-slider:hover {
    background: var(--hover-color);
  }
}
.lil-controller.lil-number .lil-slider.lil-active {
  background: var(--focus-color);
}
.lil-controller.lil-number .lil-slider.lil-active .lil-fill {
  opacity: 0.95;
}
.lil-controller.lil-number .lil-fill {
  height: 100%;
  border-right: var(--slider-knob-width) solid var(--number-color);
  box-sizing: content-box;
}

.lil-dragging .lil-gui {
  --hover-color: var(--widget-color);
}
.lil-dragging * {
  cursor: ew-resize !important;
}
.lil-dragging.lil-vertical * {
  cursor: ns-resize !important;
}

.lil-gui .lil-title {
  height: var(--title-height);
  font-weight: 600;
  padding: 0 var(--padding);
  width: 100%;
  text-align: left;
  background: none;
  text-decoration-skip: objects;
}
.lil-gui .lil-title:before {
  font-family: "lil-gui";
  content: "";
  padding-right: 2px;
  display: inline-block;
}
.lil-gui .lil-title:active {
  background: var(--title-background-color);
  opacity: 0.75;
}
@media (hover: hover) {
  body:not(.lil-dragging) .lil-gui .lil-title:hover {
    background: var(--title-background-color);
    opacity: 0.85;
  }
  .lil-gui .lil-title:focus {
    text-decoration: underline var(--focus-color);
  }
}
.lil-gui.lil-root > .lil-title:focus {
  text-decoration: none !important;
}
.lil-gui.lil-closed > .lil-title:before {
  content: "";
}
.lil-gui.lil-closed > .lil-children {
  transform: translateY(-7px);
  opacity: 0;
}
.lil-gui.lil-closed:not(.lil-transition) > .lil-children {
  display: none;
}
.lil-gui.lil-transition > .lil-children {
  transition-duration: 300ms;
  transition-property: height, opacity, transform;
  transition-timing-function: cubic-bezier(0.2, 0.6, 0.35, 1);
  overflow: hidden;
  pointer-events: none;
}
.lil-gui .lil-children:empty:before {
  content: "Empty";
  padding: 0 var(--padding);
  margin: var(--spacing) 0;
  display: block;
  height: var(--widget-height);
  font-style: italic;
  line-height: var(--widget-height);
  opacity: 0.5;
}
.lil-gui.lil-root > .lil-children > .lil-gui > .lil-title {
  border: 0 solid var(--widget-color);
  border-width: 1px 0;
  transition: border-color 300ms;
}
.lil-gui.lil-root > .lil-children > .lil-gui.lil-closed > .lil-title {
  border-bottom-color: transparent;
}
.lil-gui + .lil-controller {
  border-top: 1px solid var(--widget-color);
  margin-top: 0;
  padding-top: var(--spacing);
}
.lil-gui .lil-gui .lil-gui > .lil-title {
  border: none;
}
.lil-gui .lil-gui .lil-gui > .lil-children {
  border: none;
  margin-left: var(--folder-indent);
  border-left: 2px solid var(--widget-color);
}
.lil-gui .lil-gui .lil-controller {
  border: none;
}

.lil-gui label, .lil-gui input, .lil-gui button {
  -webkit-tap-highlight-color: transparent;
}
.lil-gui input {
  border: 0;
  outline: none;
  font-family: var(--font-family);
  font-size: var(--input-font-size);
  border-radius: var(--widget-border-radius);
  height: var(--widget-height);
  background: var(--widget-color);
  color: var(--text-color);
  width: 100%;
}
@media (hover: hover) {
  .lil-gui input:hover {
    background: var(--hover-color);
  }
  .lil-gui input:active {
    background: var(--focus-color);
  }
}
.lil-gui input:disabled {
  opacity: 1;
}
.lil-gui input[type=text],
.lil-gui input[type=number] {
  padding: var(--widget-padding);
  -moz-appearance: textfield;
}
.lil-gui input[type=text]:focus,
.lil-gui input[type=number]:focus {
  background: var(--focus-color);
}
.lil-gui input[type=checkbox] {
  appearance: none;
  width: var(--checkbox-size);
  height: var(--checkbox-size);
  border-radius: var(--widget-border-radius);
  text-align: center;
  cursor: pointer;
}
.lil-gui input[type=checkbox]:checked:before {
  font-family: "lil-gui";
  content: "";
  font-size: var(--checkbox-size);
  line-height: var(--checkbox-size);
}
@media (hover: hover) {
  .lil-gui input[type=checkbox]:focus {
    box-shadow: inset 0 0 0 1px var(--focus-color);
  }
}
.lil-gui button {
  outline: none;
  cursor: pointer;
  font-family: var(--font-family);
  font-size: var(--font-size);
  color: var(--text-color);
  width: 100%;
  border: none;
}
.lil-gui .lil-controller button {
  height: var(--widget-height);
  text-transform: none;
  background: var(--widget-color);
  border-radius: var(--widget-border-radius);
}
@media (hover: hover) {
  .lil-gui .lil-controller button:hover {
    background: var(--hover-color);
  }
  .lil-gui .lil-controller button:focus {
    box-shadow: inset 0 0 0 1px var(--focus-color);
  }
}
.lil-gui .lil-controller button:active {
  background: var(--focus-color);
}

@font-face {
  font-family: "lil-gui";
  src: url("data:application/font-woff2;charset=utf-8;base64,d09GMgABAAAAAALkAAsAAAAABtQAAAKVAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHFQGYACDMgqBBIEbATYCJAMUCwwABCAFhAoHgQQbHAbIDiUFEYVARAAAYQTVWNmz9MxhEgodq49wYRUFKE8GWNiUBxI2LBRaVnc51U83Gmhs0Q7JXWMiz5eteLwrKwuxHO8VFxUX9UpZBs6pa5ABRwHA+t3UxUnH20EvVknRerzQgX6xC/GH6ZUvTcAjAv122dF28OTqCXrPuyaDER30YBA1xnkVutDDo4oCi71Ca7rrV9xS8dZHbPHefsuwIyCpmT7j+MnjAH5X3984UZoFFuJ0yiZ4XEJFxjagEBeqs+e1iyK8Xf/nOuwF+vVK0ur765+vf7txotUi0m3N0m/84RGSrBCNrh8Ee5GjODjF4gnWP+dJrH/Lk9k4oT6d+gr6g/wssA2j64JJGP6cmx554vUZnpZfn6ZfX2bMwPPrlANsB86/DiHjhl0OP+c87+gaJo/gY084s3HoYL/ZkWHTRfBXvvoHnnkHvngKun4KBE/ede7tvq3/vQOxDXB1/fdNz6XbPdcr0Vhpojj9dG+owuSKFsslCi1tgEjirjXdwMiov2EioadxmqTHUCIwo8NgQaeIasAi0fTYSPTbSmwbMOFduyh9wvBrESGY0MtgRjtgQR8Q1bRPohn2UoCRZf9wyYANMXFeJTysqAe0I4mrherOekFdKMrYvJjLvOIUM9SuwYB5DVZUwwVjJJOaUnZCmcEkIZZrKqNvRGRMvmFZsmhP4VMKCSXBhSqUBxgMS7h0cZvEd71AWkEhGWaeMFcNnpqyJkyXgYL7PQ1MoSq0wDAkRtJIijkZSmqYTiSImfLiSWXIZwhRh3Rug2X0kk1Dgj+Iu43u5p98ghopcpSo0Uyc8SnjlYX59WUeaMoDqmVD2TOWD9a4pCRAzf2ECgwGcrHjPOWY9bNxq/OL3I/QjwEAAAA=") format("woff2");
}`;function Pn(F){const n=document.createElement("style");n.innerHTML=F;const a=document.querySelector("head link[rel=stylesheet], head style");a?document.head.insertBefore(n,a):document.head.appendChild(n)}let Pt=!1;class at{constructor({parent:n,autoPlace:a=n===void 0,container:o,width:w,title:_="Controls",closeFolders:I=!1,injectStyles:N=!0,touchStyles:z=!0}={}){if(this.parent=n,this.root=n?n.root:this,this.children=[],this.controllers=[],this.folders=[],this._closed=!1,this._hidden=!1,this.domElement=document.createElement("div"),this.domElement.classList.add("lil-gui"),this.$title=document.createElement("button"),this.$title.classList.add("lil-title"),this.$title.setAttribute("aria-expanded",!0),this.$title.addEventListener("click",()=>this.openAnimated(this._closed)),this.$title.addEventListener("touchstart",()=>{},{passive:!0}),this.$children=document.createElement("div"),this.$children.classList.add("lil-children"),this.domElement.appendChild(this.$title),this.domElement.appendChild(this.$children),this.title(_),this.parent){this.parent.children.push(this),this.parent.folders.push(this),this.parent.$children.appendChild(this.domElement);return}this.domElement.classList.add("lil-root"),z&&this.domElement.classList.add("lil-allow-touch-styles"),!Pt&&N&&(Pn(Un),Pt=!0),o?o.appendChild(this.domElement):a&&(this.domElement.classList.add("lil-auto-place","autoPlace"),document.body.appendChild(this.domElement)),w&&this.domElement.style.setProperty("--width",w+"px"),this._closeFolders=I}add(n,a,o,w,_){if(Object(o)===o)return new On(this,n,a,o);const I=n[a];switch(typeof I){case"number":return new In(this,n,a,o,w,_);case"boolean":return new Fn(this,n,a);case"string":return new Dn(this,n,a);case"function":return new Ze(this,n,a)}console.error(`gui.add failed
	property:`,a,`
	object:`,n,`
	value:`,I)}addColor(n,a,o=1){return new jn(this,n,a,o)}addFolder(n){const a=new at({parent:this,title:n});return this.root._closeFolders&&a.close(),a}load(n,a=!0){return n.controllers&&this.controllers.forEach(o=>{o instanceof Ze||o._name in n.controllers&&o.load(n.controllers[o._name])}),a&&n.folders&&this.folders.forEach(o=>{o._title in n.folders&&o.load(n.folders[o._title])}),this}save(n=!0){const a={controllers:{},folders:{}};return this.controllers.forEach(o=>{if(!(o instanceof Ze)){if(o._name in a.controllers)throw new Error(`Cannot save GUI with duplicate property "${o._name}"`);a.controllers[o._name]=o.save()}}),n&&this.folders.forEach(o=>{if(o._title in a.folders)throw new Error(`Cannot save GUI with duplicate folder "${o._title}"`);a.folders[o._title]=o.save()}),a}open(n=!0){return this._setClosed(!n),this.$title.setAttribute("aria-expanded",!this._closed),this.domElement.classList.toggle("lil-closed",this._closed),this}close(){return this.open(!1)}_setClosed(n){this._closed!==n&&(this._closed=n,this._callOnOpenClose(this))}show(n=!0){return this._hidden=!n,this.domElement.style.display=this._hidden?"none":"",this}hide(){return this.show(!1)}openAnimated(n=!0){return this._setClosed(!n),this.$title.setAttribute("aria-expanded",!this._closed),requestAnimationFrame(()=>{const a=this.$children.clientHeight;this.$children.style.height=a+"px",this.domElement.classList.add("lil-transition");const o=_=>{_.target===this.$children&&(this.$children.style.height="",this.domElement.classList.remove("lil-transition"),this.$children.removeEventListener("transitionend",o))};this.$children.addEventListener("transitionend",o);const w=n?this.$children.scrollHeight:0;this.domElement.classList.toggle("lil-closed",!n),requestAnimationFrame(()=>{this.$children.style.height=w+"px"})}),this}title(n){return this._title=n,this.$title.textContent=n,this}reset(n=!0){return(n?this.controllersRecursive():this.controllers).forEach(o=>o.reset()),this}onChange(n){return this._onChange=n,this}_callOnChange(n){this.parent&&this.parent._callOnChange(n),this._onChange!==void 0&&this._onChange.call(this,{object:n.object,property:n.property,value:n.getValue(),controller:n})}onFinishChange(n){return this._onFinishChange=n,this}_callOnFinishChange(n){this.parent&&this.parent._callOnFinishChange(n),this._onFinishChange!==void 0&&this._onFinishChange.call(this,{object:n.object,property:n.property,value:n.getValue(),controller:n})}onOpenClose(n){return this._onOpenClose=n,this}_callOnOpenClose(n){this.parent&&this.parent._callOnOpenClose(n),this._onOpenClose!==void 0&&this._onOpenClose.call(this,n)}destroy(){this.parent&&(this.parent.children.splice(this.parent.children.indexOf(this),1),this.parent.folders.splice(this.parent.folders.indexOf(this),1)),this.domElement.parentElement&&this.domElement.parentElement.removeChild(this.domElement),Array.from(this.children).forEach(n=>n.destroy())}controllersRecursive(){let n=Array.from(this.controllers);return this.folders.forEach(a=>{n=n.concat(a.controllersRecursive())}),n}foldersRecursive(){let n=Array.from(this.folders);return this.folders.forEach(a=>{n=n.concat(a.foldersRecursive())}),n}}const Le=-14,Hn={chassis_to_arm_a:24,arm_a_to_arm_b:0,arm_b_to_arm_c:0,arm_c_to_arm_d:0,arm_d_to_arm_e:0,gripper_link:8,left_bogie_to_front_left_wheel:Le,left_bogie_to_center_left_wheel:Le,left_rocker_to_back_left_wheel:Le,right_bogie_to_front_right_wheel:Le,right_bogie_to_center_right_wheel:Le,right_rocker_to_back_right_wheel:Le},et={chassis_to_arm_a:24,arm_a_to_arm_b:-.785,arm_b_to_arm_c:1.91,arm_c_to_arm_d:-1.2,arm_d_to_arm_e:-1.57,gripper_link:0,left_bogie_to_front_left_wheel:0,left_bogie_to_center_left_wheel:0,left_rocker_to_back_left_wheel:0,right_bogie_to_front_right_wheel:0,right_bogie_to_center_right_wheel:0,right_rocker_to_back_right_wheel:0};function Bn(){const F=Ke.useRef(null),n=Ke.useRef(!1);return Ke.useEffect(()=>{if(n.current||!F.current)return;n.current=!0;const a=F.current,o=new at({width:400});o.hide();const w={x:0,y:0};let _=null,I={};const N=new qt,z=new st;N.add(z),N.background=new qe(657946);const G=new Bt(16777215,.5);N.add(G);const V=new Ge(16777215,2);V.position.set(-30,150,100),V.castShadow=!0,N.add(V);const J=new Ge(10400976,1);J.position.set(-150,100,-100),N.add(J);const ee=new Ge(16777215,1);ee.position.set(2,3,2),ee.castShadow=!0,N.add(ee);const X=new yn;X.onLoad=()=>{console.log("Loading complete!");const E=kn.timeline({repeat:-1,yoyo:!0});E.to(_.position,{x:50,duration:3,ease:"power2.inOut"}),E.to(I,{...et,duration:3,ease:"power2.inOut",onUpdate:()=>{for(const y in I)_.joints[y]&&_.joints[y].setJointValue(I[y])}},"<")};const K=new Ln(X);K.packages={"":"/urdf"},K.load("/urdf/rover/rover.urdf",E=>{_=E,E.position.set(-100,0,0),E.rotation.x=-Math.PI/2,E.updateMatrixWorld(),N.add(E),I={...Hn};for(const y in I)E.joints[y]&&E.joints[y].setJointValue(I[y]);E.traverse(y=>{if(y.jointType==="revolute"||y.jointType==="continuous"||y.jointType==="prismatic"){const m=y.name||"unnamed_joint",f=typeof et[m]=="number"?et[m]:typeof y.jointValue=="number"?y.jointValue:0,O=y.limit?.lower??-Math.PI,T=y.limit?.upper??Math.PI,A={value:f};y.setJointValue(f),o.add(A,"value",O,T,.01).name(`${m} (${y.jointType})`).onChange(Y=>{y.setJointValue(Y)})}})});const M={width:window.innerWidth,height:window.innerHeight},se=new nt(75,M.width/M.height,.1,1e3);se.position.set(200,150,250),se.lookAt(0,0,0),z.add(se);const P=new _n({antialias:!0,canvas:a});P.setSize(M.width,M.height),P.setPixelRatio(Math.min(window.devicePixelRatio,2));const u=E=>{w.x=E.clientX/M.width-.5,w.y=E.clientY/M.height-.5},R=()=>{M.width=window.innerWidth,M.height=window.innerHeight,se.aspect=M.width/M.height,se.updateProjectionMatrix(),P.setSize(M.width,M.height),P.setPixelRatio(Math.min(window.devicePixelRatio,2))},q=()=>{document.fullscreenElement||document.webkitFullscreenElement?document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen&&document.webkitExitFullscreen():a.requestFullscreen?a.requestFullscreen():a.webkitRequestFullscreen&&a.webkitRequestFullscreen()};window.addEventListener("mousemove",u),window.addEventListener("resize",R),window.addEventListener("dblclick",q);const v=()=>{const E=-w.x*.2,y=-w.y*.2;z.rotation.y+=(E-z.rotation.y)*.01,z.rotation.x+=(y-z.rotation.x)*.01,P.render(N,se),window.requestAnimationFrame(v)};return v(),()=>{window.removeEventListener("mousemove",u),window.removeEventListener("resize",R),window.removeEventListener("dblclick",q),P.dispose(),o.destroy()}},[]),xn.jsx("canvas",{ref:F,className:"webgl w-full h-full fixed top-0 left-0"})}export{Bn as default};
